!function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=65)}({0:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var o=window,r=(o.$,o.jQuery)},1:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var o="www-"===location.host.substr(0,4)||"cat-"===location.host.substr(0,4)||"ia-petabox-review-"===location.host.substr(0,18)||"58-review-"===location.host.substr(0,10)?console.log.bind(console):function(){}},12:function(e,t,n){"use strict";n.d(t,"a",function(){return re}),n.d(t,"b",function(){return ne}),n.d(t,"c",function(){return N});var o=n(3),r=new WeakMap,a=function(e){return"function"==typeof e&&r.has(e)},i=void 0!==window.customElements&&void 0!==window.customElements.polyfillWrapFlushCallback,s=function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;t!==n;){var o=t.nextSibling;e.removeChild(t),t=o}},c={},l={},u="{{lit-".concat(String(Math.random()).slice(2),"}}"),d="\x3c!--".concat(u,"--\x3e"),p=new RegExp("".concat(u,"|").concat(d)),f=function e(t,n){Object(o.b)(this,e),this.parts=[],this.element=n;for(var r=[],a=[],i=document.createTreeWalker(n.content,133,null,!1),s=0,c=-1,l=0,d=t.strings,f=t.values.length;l<f;){var m=i.nextNode();if(null!==m){if(c++,1===m.nodeType){if(m.hasAttributes()){for(var b=m.attributes,g=b.length,_=0,w=0;w<g;w++)h(b[w].name,"$lit$")&&_++;for(;_-- >0;){var k=d[l],S=v.exec(k)[2],P=S.toLowerCase()+"$lit$",C=m.getAttribute(P);m.removeAttribute(P);var O=C.split(p);this.parts.push({type:"attribute",index:c,name:S,strings:O}),l+=O.length-1}}"TEMPLATE"===m.tagName&&(a.push(m),i.currentNode=m.content)}else if(3===m.nodeType){var E=m.data;if(E.indexOf(u)>=0){for(var j=m.parentNode,x=E.split(p),A=x.length-1,T=0;T<A;T++){var D=void 0,M=x[T];if(""===M)D=y();else{var $=v.exec(M);null!==$&&h($[2],"$lit$")&&(M=M.slice(0,$.index)+$[1]+$[2].slice(0,-"$lit$".length)+$[3]),D=document.createTextNode(M)}j.insertBefore(D,m),this.parts.push({type:"node",index:++c})}""===x[A]?(j.insertBefore(y(),m),r.push(m)):m.data=x[A],l+=A}}else if(8===m.nodeType)if(m.data===u){var B=m.parentNode;null!==m.previousSibling&&c!==s||(c++,B.insertBefore(y(),m)),s=c,this.parts.push({type:"node",index:c}),null===m.nextSibling?m.data="":(r.push(m),c--),l++}else for(var N=-1;-1!==(N=m.data.indexOf(u,N+1));)this.parts.push({type:"node",index:-1}),l++}else i.currentNode=a.pop()}for(var I=0,U=r;I<U.length;I++){var R=U[I];R.parentNode.removeChild(R)}},h=function(e,t){var n=e.length-t.length;return n>=0&&e.slice(n)===t},m=function(e){return-1!==e.index},y=function(){return document.createComment("")},v=/([ \x09\x0a\x0c\x0d])([^\0-\x1F\x7F-\x9F "'>=\/]+)([ \x09\x0a\x0c\x0d]*=[ \x09\x0a\x0c\x0d]*(?:[^ \x09\x0a\x0c\x0d"'`<>=]*|"[^"]*|'[^']*))$/,b=function(){function e(t,n,r){Object(o.b)(this,e),this.__parts=[],this.template=t,this.processor=n,this.options=r}return Object(o.c)(e,[{key:"update",value:function(e){var t=0,n=!0,o=!1,r=void 0;try{for(var a,i=this.__parts[Symbol.iterator]();!(n=(a=i.next()).done);n=!0){var s=a.value;void 0!==s&&s.setValue(e[t]),t++}}catch(e){o=!0,r=e}finally{try{n||null==i.return||i.return()}finally{if(o)throw r}}var c=!0,l=!1,u=void 0;try{for(var d,p=this.__parts[Symbol.iterator]();!(c=(d=p.next()).done);c=!0){var f=d.value;void 0!==f&&f.commit()}}catch(e){l=!0,u=e}finally{try{c||null==p.return||p.return()}finally{if(l)throw u}}}},{key:"_clone",value:function(){for(var e,t=i?this.template.element.content.cloneNode(!0):document.importNode(this.template.element.content,!0),n=[],r=this.template.parts,a=document.createTreeWalker(t,133,null,!1),s=0,c=0,l=a.nextNode();s<r.length;)if(e=r[s],m(e)){for(;c<e.index;)c++,"TEMPLATE"===l.nodeName&&(n.push(l),a.currentNode=l.content),null===(l=a.nextNode())&&(a.currentNode=n.pop(),l=a.nextNode());if("node"===e.type){var u=this.processor.handleTextExpression(this.options);u.insertAfterNode(l.previousSibling),this.__parts.push(u)}else{var d;(d=this.__parts).push.apply(d,Object(o.d)(this.processor.handleAttributeExpressions(l,e.name,e.strings,this.options)))}s++}else this.__parts.push(void 0),s++;return i&&(document.adoptNode(t),customElements.upgrade(t)),t}}]),e}(),g=function(){function e(t,n,r,a){Object(o.b)(this,e),this.strings=t,this.values=n,this.type=r,this.processor=a}return Object(o.c)(e,[{key:"getHTML",value:function(){for(var e=this.strings.length-1,t="",n=!1,o=0;o<e;o++){var r=this.strings[o],a=r.lastIndexOf("\x3c!--");n=(a>-1||n)&&-1===r.indexOf("--\x3e",a+1);var i=v.exec(r);t+=null===i?r+(n?u:d):r.substr(0,i.index)+i[1]+i[2]+"$lit$"+i[3]+u}return t+=this.strings[e]}},{key:"getTemplateElement",value:function(){var e=document.createElement("template");return e.innerHTML=this.getHTML(),e}}]),e}(),_=function(e){return null===e||!("object"===Object(o.a)(e)||"function"==typeof e)},w=function(e){return Array.isArray(e)||!(!e||!e[Symbol.iterator])},k=function(){function e(t,n,r){Object(o.b)(this,e),this.dirty=!0,this.element=t,this.name=n,this.strings=r,this.parts=[];for(var a=0;a<r.length-1;a++)this.parts[a]=this._createPart()}return Object(o.c)(e,[{key:"_createPart",value:function(){return new S(this)}},{key:"_getValue",value:function(){for(var e=this.strings,t=e.length-1,n="",o=0;o<t;o++){n+=e[o];var r=this.parts[o];if(void 0!==r){var a=r.value;if(_(a)||!w(a))n+="string"==typeof a?a:String(a);else{var i=!0,s=!1,c=void 0;try{for(var l,u=a[Symbol.iterator]();!(i=(l=u.next()).done);i=!0){var d=l.value;n+="string"==typeof d?d:String(d)}}catch(e){s=!0,c=e}finally{try{i||null==u.return||u.return()}finally{if(s)throw c}}}}}return n+=e[t]}},{key:"commit",value:function(){this.dirty&&(this.dirty=!1,this.element.setAttribute(this.name,this._getValue()))}}]),e}(),S=function(){function e(t){Object(o.b)(this,e),this.value=void 0,this.committer=t}return Object(o.c)(e,[{key:"setValue",value:function(e){e===c||_(e)&&e===this.value||(this.value=e,a(e)||(this.committer.dirty=!0))}},{key:"commit",value:function(){for(;a(this.value);){var e=this.value;this.value=c,e(this)}this.value!==c&&this.committer.commit()}}]),e}(),P=function(){function e(t){Object(o.b)(this,e),this.value=void 0,this.__pendingValue=void 0,this.options=t}return Object(o.c)(e,[{key:"appendInto",value:function(e){this.startNode=e.appendChild(y()),this.endNode=e.appendChild(y())}},{key:"insertAfterNode",value:function(e){this.startNode=e,this.endNode=e.nextSibling}},{key:"appendIntoPart",value:function(e){e.__insert(this.startNode=y()),e.__insert(this.endNode=y())}},{key:"insertAfterPart",value:function(e){e.__insert(this.startNode=y()),this.endNode=e.endNode,e.endNode=this.startNode}},{key:"setValue",value:function(e){this.__pendingValue=e}},{key:"commit",value:function(){for(;a(this.__pendingValue);){var e=this.__pendingValue;this.__pendingValue=c,e(this)}var t=this.__pendingValue;t!==c&&(_(t)?t!==this.value&&this.__commitText(t):t instanceof g?this.__commitTemplateResult(t):t instanceof Node?this.__commitNode(t):w(t)?this.__commitIterable(t):t===l?(this.value=l,this.clear()):this.__commitText(t))}},{key:"__insert",value:function(e){this.endNode.parentNode.insertBefore(e,this.endNode)}},{key:"__commitNode",value:function(e){this.value!==e&&(this.clear(),this.__insert(e),this.value=e)}},{key:"__commitText",value:function(e){var t=this.startNode.nextSibling,n="string"==typeof(e=null==e?"":e)?e:String(e);t===this.endNode.previousSibling&&3===t.nodeType?t.data=n:this.__commitNode(document.createTextNode(n)),this.value=e}},{key:"__commitTemplateResult",value:function(e){var t=this.options.templateFactory(e);if(this.value instanceof b&&this.value.template===t)this.value.update(e.values);else{var n=new b(t,e.processor,this.options),o=n._clone();n.update(e.values),this.__commitNode(o),this.value=n}}},{key:"__commitIterable",value:function(t){Array.isArray(this.value)||(this.value=[],this.clear());var n,o=this.value,r=0,a=!0,i=!1,s=void 0;try{for(var c,l=t[Symbol.iterator]();!(a=(c=l.next()).done);a=!0){var u=c.value;void 0===(n=o[r])&&(n=new e(this.options),o.push(n),0===r?n.appendIntoPart(this):n.insertAfterPart(o[r-1])),n.setValue(u),n.commit(),r++}}catch(e){i=!0,s=e}finally{try{a||null==l.return||l.return()}finally{if(i)throw s}}r<o.length&&(o.length=r,this.clear(n&&n.endNode))}},{key:"clear",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.startNode;s(this.startNode.parentNode,e.nextSibling,this.endNode)}}]),e}(),C=function(){function e(t,n,r){if(Object(o.b)(this,e),this.value=void 0,this.__pendingValue=void 0,2!==r.length||""!==r[0]||""!==r[1])throw new Error("Boolean attributes can only contain a single expression");this.element=t,this.name=n,this.strings=r}return Object(o.c)(e,[{key:"setValue",value:function(e){this.__pendingValue=e}},{key:"commit",value:function(){for(;a(this.__pendingValue);){var e=this.__pendingValue;this.__pendingValue=c,e(this)}if(this.__pendingValue!==c){var t=!!this.__pendingValue;this.value!==t&&(t?this.element.setAttribute(this.name,""):this.element.removeAttribute(this.name),this.value=t),this.__pendingValue=c}}}]),e}(),O=function(e){function t(e,n,r){var a;return Object(o.b)(this,t),(a=Object(o.f)(this,Object(o.g)(t).call(this,e,n,r))).single=2===r.length&&""===r[0]&&""===r[1],a}return Object(o.e)(t,e),Object(o.c)(t,[{key:"_createPart",value:function(){return new E(this)}},{key:"_getValue",value:function(){return this.single?this.parts[0].value:Object(o.h)(Object(o.g)(t.prototype),"_getValue",this).call(this)}},{key:"commit",value:function(){this.dirty&&(this.dirty=!1,this.element[this.name]=this._getValue())}}]),t}(k),E=function(e){function t(){return Object(o.b)(this,t),Object(o.f)(this,Object(o.g)(t).apply(this,arguments))}return Object(o.e)(t,e),t}(S),j=!1;
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */try{var x={get capture(){return j=!0,!1}};window.addEventListener("test",x,x),window.removeEventListener("test",x,x)}catch(e){}var A=function(){function e(t,n,r){var a=this;Object(o.b)(this,e),this.value=void 0,this.__pendingValue=void 0,this.element=t,this.eventName=n,this.eventContext=r,this.__boundHandleEvent=function(e){return a.handleEvent(e)}}return Object(o.c)(e,[{key:"setValue",value:function(e){this.__pendingValue=e}},{key:"commit",value:function(){for(;a(this.__pendingValue);){var e=this.__pendingValue;this.__pendingValue=c,e(this)}if(this.__pendingValue!==c){var t=this.__pendingValue,n=this.value,o=null==t||null!=n&&(t.capture!==n.capture||t.once!==n.once||t.passive!==n.passive),r=null!=t&&(null==n||o);o&&this.element.removeEventListener(this.eventName,this.__boundHandleEvent,this.__options),r&&(this.__options=T(t),this.element.addEventListener(this.eventName,this.__boundHandleEvent,this.__options)),this.value=t,this.__pendingValue=c}}},{key:"handleEvent",value:function(e){"function"==typeof this.value?this.value.call(this.eventContext||this.element,e):this.value.handleEvent(e)}}]),e}(),T=function(e){return e&&(j?{capture:e.capture,passive:e.passive,once:e.once}:e.capture)},D=new(function(){function e(){Object(o.b)(this,e)}return Object(o.c)(e,[{key:"handleAttributeExpressions",value:function(e,t,n,o){var r=t[0];return"."===r?new O(e,t.slice(1),n).parts:"@"===r?[new A(e,t.slice(1),o.eventContext)]:"?"===r?[new C(e,t.slice(1),n)]:new k(e,t,n).parts}},{key:"handleTextExpression",value:function(e){return new P(e)}}]),e}());
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
function M(e){var t=$.get(e.type);void 0===t&&(t={stringsArray:new WeakMap,keyString:new Map},$.set(e.type,t));var n=t.stringsArray.get(e.strings);if(void 0!==n)return n;var o=e.strings.join(u);return void 0===(n=t.keyString.get(o))&&(n=new f(e,e.getTemplateElement()),t.keyString.set(o,n)),t.stringsArray.set(e.strings,n),n}var $=new Map,B=new WeakMap;
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
(window.litHtmlVersions||(window.litHtmlVersions=[])).push("1.1.1");var N=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];return new g(e,n,"html",D)},I=133;function U(e,t){for(var n=e.element.content,o=e.parts,r=document.createTreeWalker(n,I,null,!1),a=F(o),i=o[a],s=-1,c=0,l=[],u=null;r.nextNode();){s++;var d=r.currentNode;for(d.previousSibling===u&&(u=null),t.has(d)&&(l.push(d),null===u&&(u=d)),null!==u&&c++;void 0!==i&&i.index===s;)i.index=null!==u?-1:i.index-c,i=o[a=F(o,a)]}l.forEach(function(e){return e.parentNode.removeChild(e)})}var R=function(e){for(var t=11===e.nodeType?0:1,n=document.createTreeWalker(e,I,null,!1);n.nextNode();)t++;return t},F=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=t+1;n<e.length;n++){var o=e[n];if(m(o))return n}return-1};var L=function(e,t){return"".concat(e,"--").concat(t)},q=!0;void 0===window.ShadyCSS?q=!1:void 0===window.ShadyCSS.prepareTemplateDom&&(console.warn("Incompatible ShadyCSS version detected. Please update to at least @webcomponents/webcomponentsjs@2.0.2 and @webcomponents/shadycss@1.3.1."),q=!1);var z=function(e){return function(t){var n=L(t.type,e),o=$.get(n);void 0===o&&(o={stringsArray:new WeakMap,keyString:new Map},$.set(n,o));var r=o.stringsArray.get(t.strings);if(void 0!==r)return r;var a=t.strings.join(u);if(void 0===(r=o.keyString.get(a))){var i=t.getTemplateElement();q&&window.ShadyCSS.prepareTemplateDom(i,e),r=new f(t,i),o.keyString.set(a,r)}return o.stringsArray.set(t.strings,r),r}},V=["html","svg"],H=new Set,G=function(e,t,n){H.add(e);var o=n?n.element:document.createElement("template"),r=t.querySelectorAll("style"),a=r.length;if(0!==a){for(var i=document.createElement("style"),s=0;s<a;s++){var c=r[s];c.parentNode.removeChild(c),i.textContent+=c.textContent}!function(e){V.forEach(function(t){var n=$.get(L(t,e));void 0!==n&&n.keyString.forEach(function(e){var t=e.element.content,n=new Set;Array.from(t.querySelectorAll("style")).forEach(function(e){n.add(e)}),U(e,n)})})}(e);var l=o.content;n?function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=e.element.content,r=e.parts;if(null!=n)for(var a=document.createTreeWalker(o,I,null,!1),i=F(r),s=0,c=-1;a.nextNode();)for(c++,a.currentNode===n&&(s=R(t),n.parentNode.insertBefore(t,n));-1!==i&&r[i].index===c;){if(s>0){for(;-1!==i;)r[i].index+=s,i=F(r,i);return}i=F(r,i)}else o.appendChild(t)}(n,i,l.firstChild):l.insertBefore(i,l.firstChild),window.ShadyCSS.prepareTemplateStyles(o,e);var u=l.querySelector("style");if(window.ShadyCSS.nativeShadow&&null!==u)t.insertBefore(u.cloneNode(!0),t.firstChild);else if(n){l.insertBefore(i,l.firstChild);var d=new Set;d.add(i),U(n,d)}}else window.ShadyCSS.prepareTemplateStyles(o,e)};window.JSCompiler_renameProperty=function(e,t){return e};var W={toAttribute:function(e,t){switch(t){case Boolean:return e?"":null;case Object:case Array:return null==e?e:JSON.stringify(e)}return e},fromAttribute:function(e,t){switch(t){case Boolean:return null!==e;case Number:return null===e?null:Number(e);case Object:case Array:return JSON.parse(e)}return e}},J=function(e,t){return t!==e&&(t==t||e==e)},K={attribute:!0,type:String,converter:W,reflect:!1,hasChanged:J},Y=Promise.resolve(!0),Z=function(e){function t(){var e;return Object(o.b)(this,t),(e=Object(o.f)(this,Object(o.g)(t).call(this)))._updateState=0,e._instanceProperties=void 0,e._updatePromise=Y,e._hasConnectedResolver=void 0,e._changedProperties=new Map,e._reflectingProperties=void 0,e.initialize(),e}var n;return Object(o.e)(t,e),Object(o.c)(t,[{key:"initialize",value:function(){this._saveInstanceProperties(),this._requestUpdate()}},{key:"_saveInstanceProperties",value:function(){var e=this;this.constructor._classProperties.forEach(function(t,n){if(e.hasOwnProperty(n)){var o=e[n];delete e[n],e._instanceProperties||(e._instanceProperties=new Map),e._instanceProperties.set(n,o)}})}},{key:"_applyInstanceProperties",value:function(){var e=this;this._instanceProperties.forEach(function(t,n){return e[n]=t}),this._instanceProperties=void 0}},{key:"connectedCallback",value:function(){this._updateState=32|this._updateState,this._hasConnectedResolver&&(this._hasConnectedResolver(),this._hasConnectedResolver=void 0)}},{key:"disconnectedCallback",value:function(){}},{key:"attributeChangedCallback",value:function(e,t,n){t!==n&&this._attributeToProperty(e,n)}},{key:"_propertyToAttribute",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:K,o=this.constructor,r=o._attributeNameForProperty(e,n);if(void 0!==r){var a=o._propertyValueToAttribute(t,n);if(void 0===a)return;this._updateState=8|this._updateState,null==a?this.removeAttribute(r):this.setAttribute(r,a),this._updateState=-9&this._updateState}}},{key:"_attributeToProperty",value:function(e,t){if(!(8&this._updateState)){var n=this.constructor,o=n._attributeToPropertyMap.get(e);if(void 0!==o){var r=n._classProperties.get(o)||K;this._updateState=16|this._updateState,this[o]=n._propertyValueFromAttribute(t,r),this._updateState=-17&this._updateState}}}},{key:"_requestUpdate",value:function(e,t){var n=!0;if(void 0!==e){var o=this.constructor,r=o._classProperties.get(e)||K;o._valueHasChanged(this[e],t,r.hasChanged)?(this._changedProperties.has(e)||this._changedProperties.set(e,t),!0!==r.reflect||16&this._updateState||(void 0===this._reflectingProperties&&(this._reflectingProperties=new Map),this._reflectingProperties.set(e,r))):n=!1}!this._hasRequestedUpdate&&n&&this._enqueueUpdate()}},{key:"requestUpdate",value:function(e,t){return this._requestUpdate(e,t),this.updateComplete}},{key:"_enqueueUpdate",value:(n=Object(o.j)(regeneratorRuntime.mark(function e(){var t,n,o,r,a=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this._updateState=4|this._updateState,o=this._updatePromise,this._updatePromise=new Promise(function(e,o){t=e,n=o}),e.prev=3,e.next=6,o;case 6:e.next=10;break;case 8:e.prev=8,e.t0=e.catch(3);case 10:if(this._hasConnected){e.next=13;break}return e.next=13,new Promise(function(e){return a._hasConnectedResolver=e});case 13:if(e.prev=13,null==(r=this.performUpdate())){e.next=18;break}return e.next=18,r;case 18:e.next=23;break;case 20:e.prev=20,e.t1=e.catch(13),n(e.t1);case 23:t(!this._hasRequestedUpdate);case 24:case"end":return e.stop()}},e,this,[[3,8],[13,20]])})),function(){return n.apply(this,arguments)})},{key:"performUpdate",value:function(){this._instanceProperties&&this._applyInstanceProperties();var e=!1,t=this._changedProperties;try{(e=this.shouldUpdate(t))&&this.update(t)}catch(t){throw e=!1,t}finally{this._markUpdated()}e&&(1&this._updateState||(this._updateState=1|this._updateState,this.firstUpdated(t)),this.updated(t))}},{key:"_markUpdated",value:function(){this._changedProperties=new Map,this._updateState=-5&this._updateState}},{key:"_getUpdateComplete",value:function(){return this._updatePromise}},{key:"shouldUpdate",value:function(e){return!0}},{key:"update",value:function(e){var t=this;void 0!==this._reflectingProperties&&this._reflectingProperties.size>0&&(this._reflectingProperties.forEach(function(e,n){return t._propertyToAttribute(n,t[n],e)}),this._reflectingProperties=void 0)}},{key:"updated",value:function(e){}},{key:"firstUpdated",value:function(e){}},{key:"_hasConnected",get:function(){return 32&this._updateState}},{key:"_hasRequestedUpdate",get:function(){return 4&this._updateState}},{key:"hasUpdated",get:function(){return 1&this._updateState}},{key:"updateComplete",get:function(){return this._getUpdateComplete()}}],[{key:"_ensureClassProperties",value:function(){var e=this;if(!this.hasOwnProperty(JSCompiler_renameProperty("_classProperties",this))){this._classProperties=new Map;var t=Object.getPrototypeOf(this)._classProperties;void 0!==t&&t.forEach(function(t,n){return e._classProperties.set(n,t)})}}},{key:"createProperty",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:K;if(this._ensureClassProperties(),this._classProperties.set(e,t),!t.noAccessor&&!this.prototype.hasOwnProperty(e)){var n="symbol"===Object(o.a)(e)?Symbol():"__".concat(e);Object.defineProperty(this.prototype,e,{get:function(){return this[n]},set:function(t){var o=this[e];this[n]=t,this._requestUpdate(e,o)},configurable:!0,enumerable:!0})}}},{key:"finalize",value:function(){var e=Object.getPrototypeOf(this);if(e.hasOwnProperty("finalized")||e.finalize(),this.finalized=!0,this._ensureClassProperties(),this._attributeToPropertyMap=new Map,this.hasOwnProperty(JSCompiler_renameProperty("properties",this))){var t=this.properties,n=[].concat(Object(o.d)(Object.getOwnPropertyNames(t)),Object(o.d)("function"==typeof Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(t):[])),r=!0,a=!1,i=void 0;try{for(var s,c=n[Symbol.iterator]();!(r=(s=c.next()).done);r=!0){var l=s.value;this.createProperty(l,t[l])}}catch(e){a=!0,i=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw i}}}}},{key:"_attributeNameForProperty",value:function(e,t){var n=t.attribute;return!1===n?void 0:"string"==typeof n?n:"string"==typeof e?e.toLowerCase():void 0}},{key:"_valueHasChanged",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:J;return n(e,t)}},{key:"_propertyValueFromAttribute",value:function(e,t){var n=t.type,o=t.converter||W,r="function"==typeof o?o:o.fromAttribute;return r?r(e,n):e}},{key:"_propertyValueToAttribute",value:function(e,t){if(void 0!==t.reflect){var n=t.type,o=t.converter;return(o&&o.toAttribute||W.toAttribute)(e,n)}}},{key:"observedAttributes",get:function(){var e=this;this.finalize();var t=[];return this._classProperties.forEach(function(n,o){var r=e._attributeNameForProperty(o,n);void 0!==r&&(e._attributeToPropertyMap.set(r,o),t.push(r))}),t}}]),t}(Object(o.i)(HTMLElement));Z.finalized=!0;var Q="adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,X=Symbol(),ee=function(){function e(t,n){if(Object(o.b)(this,e),n!==X)throw new Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=t}return Object(o.c)(e,[{key:"toString",value:function(){return this.cssText}},{key:"styleSheet",get:function(){return void 0===this._styleSheet&&(Q?(this._styleSheet=new CSSStyleSheet,this._styleSheet.replaceSync(this.cssText)):this._styleSheet=null),this._styleSheet}}]),e}(),te=function(e){if(e instanceof ee)return e.cssText;if("number"==typeof e)return e;throw new Error("Value passed to 'css' function must be a 'css' function result: ".concat(e,". Use 'unsafeCSS' to pass non-literal values, but\n            take care to ensure page security."))},ne=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];var r=n.reduce(function(t,n,o){return t+te(n)+e[o+1]},e[0]);return new ee(r,X)};(window.litElementVersions||(window.litElementVersions=[])).push("2.2.1");var oe=function(e){return e.flat?e.flat(1/0):function e(t){for(var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=0,r=t.length;o<r;o++){var a=t[o];Array.isArray(a)?e(a,n):n.push(a)}return n}(e)},re=function(e){function t(){return Object(o.b)(this,t),Object(o.f)(this,Object(o.g)(t).apply(this,arguments))}return Object(o.e)(t,e),Object(o.c)(t,[{key:"initialize",value:function(){Object(o.h)(Object(o.g)(t.prototype),"initialize",this).call(this),this.renderRoot=this.createRenderRoot(),window.ShadowRoot&&this.renderRoot instanceof window.ShadowRoot&&this.adoptStyles()}},{key:"createRenderRoot",value:function(){return this.attachShadow({mode:"open"})}},{key:"adoptStyles",value:function(){var e=this.constructor._styles;0!==e.length&&(void 0===window.ShadyCSS||window.ShadyCSS.nativeShadow?Q?this.renderRoot.adoptedStyleSheets=e.map(function(e){return e.styleSheet}):this._needsShimAdoptedStyleSheets=!0:window.ShadyCSS.ScopingShim.prepareAdoptedCssText(e.map(function(e){return e.cssText}),this.localName))}},{key:"connectedCallback",value:function(){Object(o.h)(Object(o.g)(t.prototype),"connectedCallback",this).call(this),this.hasUpdated&&void 0!==window.ShadyCSS&&window.ShadyCSS.styleElement(this)}},{key:"update",value:function(e){var n=this;Object(o.h)(Object(o.g)(t.prototype),"update",this).call(this,e);var r=this.render();r instanceof g&&this.constructor.render(r,this.renderRoot,{scopeName:this.localName,eventContext:this}),this._needsShimAdoptedStyleSheets&&(this._needsShimAdoptedStyleSheets=!1,this.constructor._styles.forEach(function(e){var t=document.createElement("style");t.textContent=e.cssText,n.renderRoot.appendChild(t)}))}},{key:"render",value:function(){}}],[{key:"finalize",value:function(){Object(o.h)(Object(o.g)(t),"finalize",this).call(this),this._styles=this.hasOwnProperty(JSCompiler_renameProperty("styles",this))?this._getUniqueStyles():this._styles||[]}},{key:"_getUniqueStyles",value:function(){var e=this.styles,t=[];Array.isArray(e)?oe(e).reduceRight(function(e,t){return e.add(t),e},new Set).forEach(function(e){return t.unshift(e)}):e&&t.push(e);return t}}]),t}(Z);re.finalized=!0,re.render=function(e,t,n){if(!n||"object"!==Object(o.a)(n)||!n.scopeName)throw new Error("The `scopeName` option is required.");var r=n.scopeName,a=B.has(t),i=q&&11===t.nodeType&&!!t.host,c=i&&!H.has(r),l=c?document.createDocumentFragment():t;if(function(e,t,n){var o=B.get(t);void 0===o&&(s(t,t.firstChild),B.set(t,o=new P(Object.assign({templateFactory:M},n))),o.appendInto(t)),o.setValue(e),o.commit()}(e,l,Object.assign({templateFactory:z(r)},n)),c){var u=B.get(l);B.delete(l);var d=u.value instanceof b?u.value.template:void 0;G(r,l,d),s(t,t.firstChild),t.appendChild(l),B.set(t,u)}!a&&i&&window.ShadyCSS.styleElement(t.host)}},18:function(e,t,n){"use strict";function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],o=!0,r=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(o=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);o=!0);}catch(e){r=!0,a=e}finally{try{o||null==s.return||s.return()}finally{if(r)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}t.a=function(){var e=window.location.search.substring(1),t={};return e.length>0&&e.split("&").forEach(function(e){var n=o(e.split("="),2),r=n[0],a=n[1];t[r]=decodeURIComponent(a)}),t}},3:function(e,t,n){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t,n,o,r,a,i){try{var s=e[a](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(o,r)}function a(e){return function(){var t=this,n=arguments;return new Promise(function(o,a){var i=e.apply(t,n);function s(e){r(i,o,a,s,c,"next",e)}function c(e){r(i,o,a,s,c,"throw",e)}s(void 0)})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function c(e,t,n){return t&&s(e.prototype,t),n&&s(e,n),e}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function p(e,t,n){return(p=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()?Reflect.construct:function(e,t,n){var o=[null];o.push.apply(o,t);var r=new(Function.bind.apply(e,o));return n&&d(r,n.prototype),r}).apply(null,arguments)}function f(e){var t="function"==typeof Map?new Map:void 0;return(f=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,o)}function o(){return p(e,arguments,u(this).constructor)}return o.prototype=Object.create(e.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),d(o,e)})(e)}function h(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function m(e,t,n){return(m="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=u(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function y(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}n.d(t,"a",function(){return o}),n.d(t,"b",function(){return i}),n.d(t,"c",function(){return c}),n.d(t,"d",function(){return y}),n.d(t,"e",function(){return l}),n.d(t,"f",function(){return h}),n.d(t,"g",function(){return u}),n.d(t,"h",function(){return m}),n.d(t,"i",function(){return f}),n.d(t,"j",function(){return a})},65:function(e,t,n){"use strict";n.r(t);var o=n(18),r=n(1);var a=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=document.getElementsByTagName("head")[0],r=document.createElement("script");r.src=e,r.type="text/javascript",Object.keys(n).forEach(function(e){return r.setAttribute(e,n[e])}),r.onload=t,r.onreadystatechange=function(){"complete"===r.readyState&&t()},o.appendChild(r)};function i(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var s=function(){function e(t,n,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$form=t,this.$trigger=n,this.setDonationCookie=o||$.noop,this.bindEvents()}var t,n,o;return t=e,o=[{key:"validateDonorEmail",value:function(e){return/.+@.+\..+/.test(e)}},{key:"validateNameField",value:function(e){return!/[<>&:?'"]/.test(e)}}],(n=[{key:"bindEvents",value:function(){var t=this,n=$("#donate_dropdown"),o=$("#close_donate_dropdown"),r=this.$form.attr("data-base-url")||"https://archive.org";this.$trigger.on("click.".concat("RemindForm"),function(e){n.hasClass("is-open")||n.addClass("is-open"),t.$form.find("input").filter(function(e,t){return!t.value}).eq(0).focus(),e.preventDefault()}),o.on("click.".concat("RemindForm"),function(){n.removeClass("is-open"),t.$trigger.focus()}),$(window).on("keydown.".concat("RemindForm"),function(e){n.hasClass("is-open")&&27===e.keyCode&&o.click()}),this.$form.on("submit.".concat("RemindForm"),function(n){if(n.preventDefault(),e.validateDonorEmail(t.$form.find("[name=email]").val())){["first-name","last-name"].forEach(function(n){e.validateNameField(t.$form.find("[name='".concat(n,"']")).val())||t.$form.find("[name='".concat(n,"']")).val("")});var o=t.$trigger.attr("data-source-context")||"";"undefined"!=typeof archive_analytics&&archive_analytics.send_event("DonateBanner".concat(o),"MaybeLaterFormSubmit",window.location.pathname,{service:"ao_no_sampling"}),t.sendForm(r)}else t.$form.find(".error-email").show()})}},{key:"sendForm",value:function(e){var t=this,n=$("#donate_reminder_success").addClass("hidden"),o=function(e,t){return"<h2>".concat(e,"</h2><p>").concat(t,"</p>")};$.ajax({type:"post",url:"".concat(e,"/donate/remindDonate.php"),data:this.$form.serialize(),success:function(){t.$form.addClass("hidden"),n.html(o("Thank You!","Your reminder has been set.")).removeClass("hidden"),t.setDonationCookie(45)},error:function(){n.html(o("Hmmm...","Something is amiss. Can you try again in a little while?")).removeClass("hidden")}})}}])&&i(t.prototype,n),o&&i(t,o),e}();window.RemindForm=s;var c={errorSelector:"#comment-error",namespace:"comment_form",renderError:function(e){var t=this;$("<p />",{id:this.errorSelector.replace(/^#/,""),text:"Please correct the marked fields. All fields are required."}).prependTo(this.$form),e.forEach(function(e){t.$form.find("#".concat(e)).addClass("error")})},renderSubmitError:function(){$("<p />",{id:this.errorSelector.replace(/^#/,""),html:'Whoops! Something didn\'t work quite right. You can always email <a href="mailto:donations@archive.org">donations@archive.org</a> with your comment instead.'}).prependTo(this.$form)},renderNewsletterError:function(){this.$form.find("#newsletter-error").css({color:"red"}).html("*Please provide your email above")},removeError:function(){this.$form.find(".error").removeClass("error"),this.$form.find(this.errorSelector).remove()},sendComment:function(){return $.ajax({url:this.$form.attr("action"),type:this.$form.attr("method"),data:this.$form.serialize()})},disableSubmit:function(){this.$element.off(".".concat(this.namespace)).on("submit.".concat(this.namespace),!1),this.$element.find(":submit").attr("disabled",!0)},enableSubmit:function(){this.$element.add(this.$form).off(".".concat(this.namespace)),this.bindEvents(),this.$element.find(":submit").removeAttr("disabled")},handleSubmit:function(e){var t=this;e.preventDefault();var n=this.$form.find("#newsletter").is(":checked"),o=this.$form.find("#contact").val(),r=[];if(this.disableSubmit(),this.removeError(),["name","contact","comment"].forEach(function(e){t.$form.find("#".concat(e)).val()||r.push(e)}),n&&!o&&(this.renderNewsletterError(),this.enableSubmit()),r.length)return this.renderError(r),void this.enableSubmit();this.sendComment().done(this.renderThankYou.bind(this)).fail(this.renderAjaxError.bind(this))},renderThankYou:function(e){var t=this.$form.find("#newsletter").is(":checked");this.$element.html('\n      <div class="thanks-message">\n        <h2>Thank you again for your support!</h2>\n        '.concat(e.subscription_updated?'<p>We have updated your preferences, feel free to go to your <a href="/account/index.php?settings=1">settings</a> and change anytime.</p>':"","\n        ").concat(!e.subscription_updated&&t?"<p>Thanks also for subscribing to our newsletter.  We are excited to bring you updates on what's happening around the archive.</p>":"",'\n        <p>Your comment has been submitted.</p>\n        <p>You will be redirected to <a href="//archive.org">archive.org</a> in 10 seconds.</p>\n      </div>\n    ')),setTimeout(function(){window.location="https://archive.org"},1e4)},renderAjaxError:function(e,t){this.enableSubmit(),this.renderSubmitError(),Object(r.a)("CommentForm.sendComment - error: ".concat(t))},bindEvents:function(){this.$form.on("submit.".concat(this.namespace),this.handleSubmit.bind(this))},init:function(){this.$element=$(".body-section"),this.$form=this.$element.find("#post-donation-survey"),this.$form.length&&this.bindEvents()}},l={input:{"font-size":"14px","font-family":'"Helvetica Neue", Helvetica, Arial, sans-serif',"font-weight":"700",color:"#333"},":focus":{color:"#333"},".valid":{},".invalid":{color:"#b00b00"}},u={number:{selector:"#bt_card-number",placeholder:"Card number"},cvv:{selector:"#bt_cvv",placeholder:"CVC"},expirationDate:{selector:"#bt_expiration",placeholder:"MM / YY"}},d={HOSTED_FIELDS_FIELDS_EMPTY:"Some payment information below is missing or incorrect.",HOSTED_FIELDS_FIELDS_INVALID:"Some payment information below is missing or incorrect.",defaultMessage:"We're sorry, but we were unable to process your donation. Please contact donations@archive.org for assistance."},p={AF:"Afghanistan",AX:"Aland Islands",AL:"Albania",DZ:"Algeria",AS:"American Samoa",AD:"Andorra",AO:"Angola",AI:"Anguilla",AQ:"Antarctica",AG:"Antigua and Barbuda",AR:"Argentina",AM:"Armenia",AW:"Aruba",AU:"Australia",AT:"Austria",AZ:"Azerbaijan",BS:"Bahamas",BH:"Bahrain",BD:"Bangladesh",BB:"Barbados",BY:"Belarus",BE:"Belgium",BZ:"Belize",BJ:"Benin",BM:"Bermuda",BT:"Bhutan",BO:"Bolivia",BQ:"Bonaire, Saint Eustatius and Saba ",BA:"Bosnia and Herzegovina",BW:"Botswana",BV:"Bouvet Island",BR:"Brazil",IO:"British Indian Ocean Territory",VG:"British Virgin Islands",BN:"Brunei",BG:"Bulgaria",BF:"Burkina Faso",BI:"Burundi",KH:"Cambodia",CM:"Cameroon",CA:"Canada",CV:"Cape Verde",KY:"Cayman Islands",CF:"Central African Republic",TD:"Chad",CL:"Chile",CN:"China",CX:"Christmas Island",CC:"Cocos Islands",CO:"Colombia",KM:"Comoros",CK:"Cook Islands",CR:"Costa Rica",HR:"Croatia",CU:"Cuba",CW:"Curacao",CY:"Cyprus",CZ:"Czech Republic",CD:"Democratic Republic of the Congo",DK:"Denmark",DJ:"Djibouti",DM:"Dominica",DO:"Dominican Republic",TL:"East Timor",EC:"Ecuador",EG:"Egypt",SV:"El Salvador",GQ:"Equatorial Guinea",ER:"Eritrea",EE:"Estonia",ET:"Ethiopia",FK:"Falkland Islands",FO:"Faroe Islands",FJ:"Fiji",FI:"Finland",FR:"France",GF:"French Guiana",PF:"French Polynesia",TF:"French Southern Territories",GA:"Gabon",GM:"Gambia",GE:"Georgia",DE:"Germany",GH:"Ghana",GI:"Gibraltar",GR:"Greece",GL:"Greenland",GD:"Grenada",GP:"Guadeloupe",GU:"Guam",GT:"Guatemala",GG:"Guernsey",GN:"Guinea",GW:"Guinea-Bissau",GY:"Guyana",HT:"Haiti",HM:"Heard Island and McDonald Islands",HN:"Honduras",HK:"Hong Kong",HU:"Hungary",IS:"Iceland",IN:"India",ID:"Indonesia",IR:"Iran",IQ:"Iraq",IE:"Ireland",IM:"Isle of Man",IL:"Israel",IT:"Italy",CI:"Ivory Coast",JM:"Jamaica",JP:"Japan",JE:"Jersey",JO:"Jordan",KZ:"Kazakhstan",KE:"Kenya",KI:"Kiribati",XK:"Kosovo",KW:"Kuwait",KG:"Kyrgyzstan",LA:"Laos",LV:"Latvia",LB:"Lebanon",LS:"Lesotho",LR:"Liberia",LY:"Libya",LI:"Liechtenstein",LT:"Lithuania",LU:"Luxembourg",MO:"Macao",MK:"Macedonia",MG:"Madagascar",MW:"Malawi",MY:"Malaysia",MV:"Maldives",ML:"Mali",MT:"Malta",MH:"Marshall Islands",MQ:"Martinique",MR:"Mauritania",MU:"Mauritius",YT:"Mayotte",MX:"Mexico",FM:"Micronesia",MD:"Moldova",MC:"Monaco",MN:"Mongolia",ME:"Montenegro",MS:"Montserrat",MA:"Morocco",MZ:"Mozambique",MM:"Myanmar",NA:"Namibia",NR:"Nauru",NP:"Nepal",NL:"Netherlands",NC:"New Caledonia",NZ:"New Zealand",NI:"Nicaragua",NE:"Niger",NG:"Nigeria",NU:"Niue",NF:"Norfolk Island",KP:"North Korea",MP:"Northern Mariana Islands",NO:"Norway",OM:"Oman",PK:"Pakistan",PW:"Palau",PS:"Palestinian Territory",PA:"Panama",PG:"Papua New Guinea",PY:"Paraguay",PE:"Peru",PH:"Philippines",PN:"Pitcairn",PL:"Poland",PT:"Portugal",PR:"Puerto Rico",QA:"Qatar",CG:"Republic of the Congo",RE:"Reunion",RO:"Romania",RU:"Russia",RW:"Rwanda",BL:"Saint Barthelemy",SH:"Saint Helena",KN:"Saint Kitts and Nevis",LC:"Saint Lucia",MF:"Saint Martin",PM:"Saint Pierre and Miquelon",VC:"Saint Vincent and the Grenadines",WS:"Samoa",SM:"San Marino",ST:"Sao Tome and Principe",SA:"Saudi Arabia",SN:"Senegal",RS:"Serbia",SC:"Seychelles",SL:"Sierra Leone",SG:"Singapore",SX:"Sint Maarten",SK:"Slovakia",SI:"Slovenia",SB:"Solomon Islands",SO:"Somalia",ZA:"South Africa",GS:"South Georgia and the South Sandwich Islands",KR:"South Korea",SS:"South Sudan",ES:"Spain",LK:"Sri Lanka",SD:"Sudan",SR:"Suriname",SJ:"Svalbard and Jan Mayen",SZ:"Swaziland",SE:"Sweden",CH:"Switzerland",SY:"Syria",TW:"Taiwan",TJ:"Tajikistan",TZ:"Tanzania",TH:"Thailand",TG:"Togo",TK:"Tokelau",TO:"Tonga",TT:"Trinidad and Tobago",TN:"Tunisia",TR:"Turkey",TM:"Turkmenistan",TC:"Turks and Caicos Islands",TV:"Tuvalu",VI:"U.S. Virgin Islands",UG:"Uganda",UA:"Ukraine",AE:"United Arab Emirates",GB:"United Kingdom",UM:"United States Minor Outlying Islands",US:"United States",UY:"Uruguay",UZ:"Uzbekistan",VU:"Vanuatu",VA:"Vatican",VE:"Venezuela",VN:"Vietnam",WF:"Wallis and Futuna",EH:"Western Sahara",YE:"Yemen",ZM:"Zambia",ZW:"Zimbabwe"},f=n(12);function h(e){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function m(){var e=v(["\n      .processing-image svg {\n        margin: auto;\n        width: 75px;\n        height: 75px;\n      }\n\n      .progress-indicator {\n        opacity: 0;\n        transition: opacity 0.25s ease-out;\n      }\n\n      .loading .progress-indicator {\n        opacity: 1;\n      }\n\n      .loaded-indicator {\n        opacity: 1;\n        transition: opacity 0.25s ease-out;\n      }\n\n      .loading .loaded-indicator {\n        opacity: 0;\n      }\n\n      .image {\n        border: 1px solid red;\n        display: inline-block;\n      }\n\n      .loading #progress-ring {\n        animation: rotate 1.3s infinite linear;\n        transform-origin: 50px 50px;\n        transform-box: fill-box;\n      }\n\n      .loading #left-dot {\n        opacity: 0;\n        animation: dot 1.3s infinite;\n        animation-delay: 0.2s;\n      }\n\n      .loading #middle-dot {\n        opacity: 0;\n        animation: dot 1.3s infinite;\n        animation-delay: 0.4s;\n      }\n\n      .loading #right-dot {\n        opacity: 0;\n        animation: dot 1.3s infinite;\n        animation-delay: 0.6s;\n      }\n\n      @keyframes rotate {\n        0% {\n          transform: rotate(-360deg);\n        }\n      }\n\n      @keyframes dot {\n        0% {\n          opacity: 0;\n        }\n        25% {\n          opacity: 1;\n        }\n        100% {\n          opacity: 0;\n        }\n      }\n    "]);return m=function(){return e},e}function y(){var e=v(['\n    <div class="processing-image ','">\n      <svg viewBox="0 0 120 120" preserveAspectRatio="none" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        <g id="icons/check-ring---squared" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n          <path id="completed-ring" fill="#31A481" class="loaded-indicator" d="M60,10 C70.5816709,10 80.3955961,13.2871104 88.4763646,18.8959201 L78.3502633,29.0214223 C72.9767592,25.8315427 66.7022695,24 60,24 C40.117749,24 24,40.117749 24,60 C24,79.882251 40.117749,96 60,96 C79.882251,96 96,79.882251 96,60 L95.995,59.46 L108.327675,47.128668 C109.350926,50.9806166 109.925886,55.015198 109.993301,59.1731586 L110,60 C110,87.6142375 87.6142375,110 60,110 C32.3857625,110 10,87.6142375 10,60 C10,32.3857625 32.3857625,10 60,10 Z"></path>\n          <polygon id="check" class="loaded-indicator" fill="#31A481" transform="translate(75.000000, 41.500000) rotate(44.000000) translate(-75.000000, -41.500000) " points="96 85 54 85 54 65 76 64.999 76 -2 96 -2"></polygon>\n          <path id="progress-ring" class="progress-indicator" fill="#333333" d="M60,10 C69.8019971,10 78.9452178,12.8205573 86.6623125,17.6943223 L76.4086287,27.9484118 C71.4880919,25.4243078 65.9103784,24 60,24 C40.117749,24 24,40.117749 24,60 C24,79.882251 40.117749,96 60,96 C79.882251,96 96,79.882251 96,60 C96,53.3014663 94.1704984,47.0302355 90.9839104,41.6587228 L101.110332,31.5326452 C106.715332,39.6116982 110,49.4222615 110,60 C110,87.6142375 87.6142375,110 60,110 C32.3857625,110 10,87.6142375 10,60 C10,32.3857625 32.3857625,10 60,10 Z"></path>\n          <g id="progress-dots" class="progress-indicator" transform="translate(40.000000, 55.000000)" fill="#333333">\n            <circle id="left-dot" cx="5" cy="5" r="5"></circle>\n            <circle id="middle-dot" cx="20" cy="5" r="5"></circle>\n            <circle id="right-dot" cx="35" cy="5" r="5"></circle>\n          </g>\n        </g>\n      </svg>\n    </div>\n    ']);return y=function(){return e},e}function v(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function b(e,t){return!t||"object"!==h(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function w(e,t,n){return t&&_(e.prototype,t),n&&_(e,n),e}function k(e,t){return(k=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var S=Object.freeze({processing:"processing",complete:"complete"}),P=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=b(this,g(t).call(this))).mode=S.processing,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&k(e,t)}(t,f["a"]),w(t,null,[{key:"properties",get:function(){return{mode:{type:String}}}}]),w(t,[{key:"render",value:function(){return Object(f.c)(y(),this.mode===S.processing?"loading":"")}}],[{key:"styles",get:function(){return Object(f.b)(m())}}]),t}();function C(){var e=function(e,t){t||(t=e.slice(0));return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(['\n  <svg viewBox="0 0 18 18" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n    <title>Close</title>\n    <desc>Close Button</desc>\n    <g id="iconochive-remove-circle-light" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n      <path d="M15.413528,2.58408736 C14.2040701,1.44579114 12.8221688,0.678634632 11.2678239,0.282617816 C9.71347902,-0.113398999 8.1638402,-0.0932283635 6.61890744,0.343129723 C5.07397467,0.77948781 3.73778935,1.59774327 2.61035147,2.7978961 C1.47215688,3.92610699 0.70237968,5.25736895 0.301019863,6.79168198 C-0.100339954,8.325995 -0.100339954,9.85795479 0.301019863,11.3875613 C0.70237968,12.9171679 1.47215688,14.2511193 2.61035147,15.3894155 C3.74854606,16.5277117 5.08237835,17.2975576 6.61184834,17.6989533 C8.14131833,18.1003489 9.67314135,18.1003489 11.2073174,17.6989533 C12.7414935,17.2975576 14.0776788,16.5277117 15.2158734,15.3894155 C16.4152468,14.2612046 17.23074,12.9249 17.6623531,11.3805016 C18.0939661,9.83610327 18.1117819,8.28363667 17.7158005,6.72310181 C17.319819,5.16256696 16.552731,3.78289547 15.4145364,2.58408736 L15.413528,2.58408736 Z" id="Path" fill="#FFF" fill-rule="nonzero"/><polygon id="Path" fill="#000" fill-rule="nonzero" points="12.4728313 4 14 5.52716873 10.5414681 9 14 12.4585319 12.4728313 14 9 10.5271687 5.54146806 14 4 12.4585319 7.47283127 9 4 5.52716873 5.54146806 4 9 7.45853194"/>\n    </g>\n  </svg>\n']);return C=function(){return e},e}customElements.define("donation-processing-image",P);var O=Object(f.c)(C());function E(e){return(E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function j(){var e=D(["\n      :host {\n        display: none;\n        overflow: auto;\n        overflow-y: scroll;\n        position: fixed;\n        top: 0;\n        right: 0;\n        bottom: 0;\n        left: 0;\n        z-index: 1040;\n        font-family: 'Helvetica Neue', Helvetica, sans-serif;\n      }\n\n      :host([visible]) {\n        display: block;\n      }\n\n      .hidden {\n        display: none;\n      }\n\n      .modal-wrapper {\n        height: 100%;\n        margin: auto;\n      }\n\n      .head-spacer {\n        height: 50px;\n      }\n\n      .modal-container {\n        margin: auto auto 50px;\n        z-index: 1050;\n        width: 300px;\n        border-radius: 5px;\n        box-shadow: 0 12px 30px 0 rgba(0, 0, 0, 0.5), inset 0 1px 0 0 hsla(0, 0%, 100%, .65);\n      }\n\n      header {\n        position: relative;\n        background-color: #36A483;\n        color: white;\n        border-radius: 5px 5px 0 0;\n        border: 1px solid #333;\n        border-bottom: 0;\n        text-align: center;\n        padding-bottom: 0.5em;\n      }\n\n      header h1 {\n        margin: 0;\n        padding: 0;\n        padding-top: 0.25em;\n        font-size: 18px;\n        font-weight: bold;\n      }\n\n      header h2 {\n        margin: 0;\n        padding: 0;\n        font-weight: normal;\n        padding-top: 0;\n        font-size: 12px;\n      }\n\n      .body {\n        background-color: #f5f5f7;\n        border-radius: 0 0 5px 5px;\n        border: 1px solid #333;\n        border-top: 0;\n        padding: 10px;\n        color: #333;\n      }\n\n      .headline {\n        font-size: 18px;\n        font-weight: bold;\n        text-align: center;\n        line-height: 1.2em;\n        margin: 0;\n        padding: 0.5rem 0 1rem 0;\n      }\n\n      .message {\n        margin: 0.5rem 0 0 0;\n        text-align: center;\n        font-size: 14px;\n        line-height: 1.4em;\n      }\n\n      .logo-icon img {\n        border-radius: 100%;\n        border: 3px solid #fff;\n        box-shadow: 0 0 0 1px rgba(0,0,0,.18), 0 2px 2px 0 rgba(0,0,0,.08);\n        margin-top: -29px;\n        width: 65px;\n      }\n\n      .close-button {\n        position: absolute;\n        right: 16px;\n        top: 16px;\n        width: 18px;\n        height: 18px;\n        border-radius: 100%;\n        border: 0;\n        padding: 0;\n        cursor: pointer;\n      }\n\n      .processing-logo {\n        margin: auto;\n        width: 75px;\n        height: 75px;\n      }\n    "]);return j=function(){return e},e}function x(){var e=D(['<p class="message">',"</p>"]);return x=function(){return e},e}function A(){var e=D(['<h1 class="headline">',"</h1>"]);return A=function(){return e},e}function T(){var e=D(['\n    <div class="modal-wrapper">\n      <div class="head-spacer"></div>\n      <div class="modal-container">\n        <header style="background-color: ','">\n          <button type="button" class="close-button" @click=',">\n            ",'\n          </button>\n          <div class="logo-icon">\n            <img src="https://archive.org/images/logo_arches.png">\n          </div>\n          <h1>',"</h1>\n          <h2>",'</h2>\n        </header>\n        <div class="body">\n          <div class="processing-logo ','">\n            <donation-processing-image\n              .mode=',">\n            </donation-processing-image>\n          </div>\n\n          ","\n\n          ",'\n\n          <div class="slot-container">\n            <slot>\n\n            </slot>\n          </div>\n        </div>\n      </div>\n    </div>\n    ']);return T=function(){return e},e}function D(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function M(e,t){return!t||"object"!==E(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function B(e){return(B=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function N(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function I(e,t,n){return t&&N(e.prototype,t),n&&N(e,n),e}function U(e,t){return(U=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var R=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=M(this,B(t).call(this))).title="Internet Archive",e.subtitle="",e.headline="",e.message="",e.visible=!0,e.headerColor="#36A483",e.showProcessingIndicator=!1,e.processingImageMode=S.processing,e.showBackdrop=!0,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&U(e,t)}(t,f["a"]),I(t,null,[{key:"properties",get:function(){return{title:{type:String},subtitle:{type:String},headline:{type:String},message:{type:String},visible:{type:Boolean,reflect:!0},headerColor:{type:String},showProcessingIndicator:{type:Boolean},processingImageMode:{type:String},showBackdrop:{type:Boolean}}}}]),I(t,[{key:"render",value:function(){return Object(f.c)(T(),this.headerColor,this.handleCloseButton,O,this.title,this.subtitle,this.showProcessingIndicator?"":"hidden",this.processingImageMode,this.headline?Object(f.c)(A(),this.headline):"",this.message?Object(f.c)(x(),this.message):"")}},{key:"handleCloseButton",value:function(){var e=new Event("close-button-pressed");this.dispatchEvent(e)}}],[{key:"styles",get:function(){return Object(f.b)(j())}}]),t}();customElements.define("donation-modal",R);var F=function(e){var t=e.amount,n=e.frequency,o=void 0===n?"":n,r=e.referrer,a=void 0===r?"ia":r;return'<donation-modal\n    id="braintree-popup"\n    subtitle="Donate $'.concat(t," ").concat(o,'"\n    headerColor="#497fbf">\n\n    <form action="').concat(Donations.baseURL,'/services/donate.php?service=braintree" method="post" data-id="braintree">\n      <fieldset class="braintree-fields">\n        <label for="bt_email">Email</label>\n        <div class="icon_wrap email">\n        <input type="email" name="email" id="bt_email" placeholder="Email" required />\n      </fieldset>\n      <fieldset class="braintree-fields">\n        <label for="bt_first-name">First Name</label>\n        <div class="icon_wrap person">\n          <input type="text" name="firstName" id="bt_first-name" placeholder="First name" required />\n        </div>\n        <label for="bt_last-name">Last Name</label>\n        <input type="text" name="lastName" id="bt_last-name" placeholder="Last name" required />\n        <label for="bt_street-address">Address</label>\n        <div class="icon_wrap pin">\n          <input type="text" name="streetAddress" id="bt_street-address" placeholder="Address line 1" />\n        </div>\n        <label for="bt_extended-address">Address 2</label>\n        <input type="text" name="extendedAddress" id="bt_extended-address" placeholder="Address line 2" />\n        <label for="bt_city">City</label>\n        <input type="text" name="locality" id="bt_city" placeholder="City" />\n        <div class="field-row">\n          <label for="bt_state">State / Province</label>\n          <input type="text" name="region" id="bt_state" placeholder="State / Province" />\n          <label for="bt_zipcode">Zip/Postal Code</label>\n          <input type="text" name="postalCode" id="bt_zipcode" placeholder="Zip / Postal" />\n        </div>\n        <label for="bt_country">Country</label>\n        <div class="select">\n          <select name="bt_country" id="bt_country">\n            ').concat(Object.keys(p).reduce(function(e,t){return"".concat(e,"<option ").concat("US"===t?"selected ":"",'value="').concat(t,'">').concat(p[t],"</option>")},""),'\n          </select>\n        </div>\n      </fieldset>\n      <div class="braintree-fields">\n        <p class="error"></p>\n      </div>\n      <fieldset class="braintree-fields">\n        <label for="bt_card-number">Card Number</label>\n        <div class="field icon_wrap card" id="bt_card-number"></div>\n        <div class="field-row">\n          <label for="bt_expiration">Expiration</label>\n          <div class="field icon_wrap calendar" id="bt_expiration"></div>\n          <label for="bt_cvv">CVV</label>\n          <div class="field icon_wrap lock" id="bt_cvv"></div>\n        </div>\n        <input type="hidden" name="amount" id="bt_amount" />\n        <input type="hidden" name="payment_method_nonce" id="bt_nonce" />\n        <input type="hidden" name="charge-id" />\n        <input type="hidden" name="donation-type" value="braintree" />\n        <input type="hidden" name="referrer" value="').concat(a,'" />\n        <input type="hidden" name="type" value="').concat("monthly"===o?"monthly":"one-time",'" />\n      </fieldset>\n      <fieldset class="braintree-fields">\n        <input type="submit" value="Donate" class="js-cc-donate-button" />\n      </fieldset>\n    </form>\n\n  </donation-modal>\n  ')};var L=function(e){var t=e.method,n=void 0===t?"POST":t,o=e.fields,r=e.action,a=$("<form />",{action:r,method:n,css:{display:"none"},target:"_top"}).appendTo(document.body);Object.keys(o).forEach(function(e){$("<input />",{type:"text",name:e,value:o[e]}).appendTo(a)}),a.submit()},q=n(0);function z(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var V=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,o;return t=e,o=[{key:"get_banner_height",value:function(){return $("#donate_banner").outerHeight()}},{key:"postMessage",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;Object(r.a)("postin",{event:t,incomingValue:n});var o=e.get_banner_height(),a=e.preventResizeEventResponse?e.calculateBannerWithReminderForm():0,i=Math.max(a,n);window.parent.postMessage(JSON.stringify({event:t,value:i,bannerHeight:o}),"*"),"close modal"===t&&e.adjust_height()}},{key:"openReminderForm",value:function(){e.preventResizeEventResponse=!0,e.postMessage("set height"),window.scrollTo(0,0)}},{key:"closeReminderForm",value:function(){e.preventResizeEventResponse=!1,e.postMessage("close modal"),window.scrollTo(0,0)}},{key:"calculateBannerWithReminderForm",value:function(){var e=document.querySelector(".js-donate-banner"),t=document.querySelector(".js-donate-form"),n=document.querySelector(".js-donate-dropdown"),o=e.offsetHeight,r=n.offsetHeight;return o-(o-(t.offsetHeight+t.offsetTop))+r+15}},{key:"adjust_height",value:function(){var t=e.get_banner_height();e.postMessage("set height",t),Object(r.a)({banner_height:t})}},{key:"init",value:function(){Object(r.a)("donato tornado"),$(window).on("resize  orientationchange",function(){clearTimeout(e.adjust_height_throttler),e.adjust_height_throttler=setTimeout(e.adjust_height,100)}),e.adjust_height()}}],(n=null)&&z(t.prototype,n),o&&z(t,o),e}();V.preventResizeEventResponse=!1,$(V.init);var H=V,G={searchParams:"URLSearchParams"in self,iterable:"Symbol"in self&&"iterator"in Symbol,blob:"FileReader"in self&&"Blob"in self&&function(){try{return new Blob,!0}catch(e){return!1}}(),formData:"FormData"in self,arrayBuffer:"ArrayBuffer"in self};if(G.arrayBuffer)var W=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],J=ArrayBuffer.isView||function(e){return e&&W.indexOf(Object.prototype.toString.call(e))>-1};function K(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function Y(e){return"string"!=typeof e&&(e=String(e)),e}function Z(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return G.iterable&&(t[Symbol.iterator]=function(){return t}),t}function Q(e){this.map={},e instanceof Q?e.forEach(function(e,t){this.append(t,e)},this):Array.isArray(e)?e.forEach(function(e){this.append(e[0],e[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function X(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function ee(e){return new Promise(function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}})}function te(e){var t=new FileReader,n=ee(t);return t.readAsArrayBuffer(e),n}function ne(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function oe(){return this.bodyUsed=!1,this._initBody=function(e){var t;this._bodyInit=e,e?"string"==typeof e?this._bodyText=e:G.blob&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:G.formData&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:G.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():G.arrayBuffer&&G.blob&&((t=e)&&DataView.prototype.isPrototypeOf(t))?(this._bodyArrayBuffer=ne(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):G.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(e)||J(e))?this._bodyArrayBuffer=ne(e):this._bodyText=e=Object.prototype.toString.call(e):this._bodyText="",this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):G.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},G.blob&&(this.blob=function(){var e=X(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?X(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(te)}),this.text=function(){var e,t,n,o=X(this);if(o)return o;if(this._bodyBlob)return e=this._bodyBlob,t=new FileReader,n=ee(t),t.readAsText(e),n;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),n=new Array(t.length),o=0;o<t.length;o++)n[o]=String.fromCharCode(t[o]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},G.formData&&(this.formData=function(){return this.text().then(ie)}),this.json=function(){return this.text().then(JSON.parse)},this}Q.prototype.append=function(e,t){e=K(e),t=Y(t);var n=this.map[e];this.map[e]=n?n+", "+t:t},Q.prototype.delete=function(e){delete this.map[K(e)]},Q.prototype.get=function(e){return e=K(e),this.has(e)?this.map[e]:null},Q.prototype.has=function(e){return this.map.hasOwnProperty(K(e))},Q.prototype.set=function(e,t){this.map[K(e)]=Y(t)},Q.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)},Q.prototype.keys=function(){var e=[];return this.forEach(function(t,n){e.push(n)}),Z(e)},Q.prototype.values=function(){var e=[];return this.forEach(function(t){e.push(t)}),Z(e)},Q.prototype.entries=function(){var e=[];return this.forEach(function(t,n){e.push([n,t])}),Z(e)},G.iterable&&(Q.prototype[Symbol.iterator]=Q.prototype.entries);var re=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function ae(e,t){var n,o,r=(t=t||{}).body;if(e instanceof ae){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new Q(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,r||null==e._bodyInit||(r=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",!t.headers&&this.headers||(this.headers=new Q(t.headers)),this.method=(n=t.method||this.method||"GET",o=n.toUpperCase(),re.indexOf(o)>-1?o:n),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&r)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(r)}function ie(e){var t=new FormData;return e.trim().split("&").forEach(function(e){if(e){var n=e.split("="),o=n.shift().replace(/\+/g," "),r=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(o),decodeURIComponent(r))}}),t}function se(e,t){t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new Q(t.headers),this.url=t.url||"",this._initBody(e)}ae.prototype.clone=function(){return new ae(this,{body:this._bodyInit})},oe.call(ae.prototype),oe.call(se.prototype),se.prototype.clone=function(){return new se(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new Q(this.headers),url:this.url})},se.error=function(){var e=new se(null,{status:0,statusText:""});return e.type="error",e};var ce=[301,302,303,307,308];se.redirect=function(e,t){if(-1===ce.indexOf(t))throw new RangeError("Invalid status code");return new se(null,{status:t,headers:{location:e}})};var le=self.DOMException;try{new le}catch(e){(le=function(e,t){this.message=e,this.name=t;var n=Error(e);this.stack=n.stack}).prototype=Object.create(Error.prototype),le.prototype.constructor=le}function ue(e,t){return new Promise(function(n,o){var r=new ae(e,t);if(r.signal&&r.signal.aborted)return o(new le("Aborted","AbortError"));var a=new XMLHttpRequest;function i(){a.abort()}a.onload=function(){var e,t,o={status:a.status,statusText:a.statusText,headers:(e=a.getAllResponseHeaders()||"",t=new Q,e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach(function(e){var n=e.split(":"),o=n.shift().trim();if(o){var r=n.join(":").trim();t.append(o,r)}}),t)};o.url="responseURL"in a?a.responseURL:o.headers.get("X-Request-URL");var r="response"in a?a.response:a.responseText;n(new se(r,o))},a.onerror=function(){o(new TypeError("Network request failed"))},a.ontimeout=function(){o(new TypeError("Network request failed"))},a.onabort=function(){o(new le("Aborted","AbortError"))},a.open(r.method,r.url,!0),"include"===r.credentials?a.withCredentials=!0:"omit"===r.credentials&&(a.withCredentials=!1),"responseType"in a&&G.blob&&(a.responseType="blob"),r.headers.forEach(function(e,t){a.setRequestHeader(t,e)}),r.signal&&(r.signal.addEventListener("abort",i),a.onreadystatechange=function(){4===a.readyState&&r.signal.removeEventListener("abort",i)}),a.send(void 0===r._bodyInit?null:r._bodyInit)})}function de(e){return(de="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pe(){var e=ge(["\n      .container {\n        text-align: center;\n        margin-top: 2rem;\n      }\n\n      .error {\n        font-weight: 600;\n        color: #b00b00;\n      }\n\n      .amount-box {\n        background-color: #fff;\n        padding: 5px 0.625em;\n        border-radius: 5px;\n      }\n\n      .amount-box input {\n        width: 100px;\n        text-align: center;\n        border: none;\n        border-bottom: 1px solid gray;\n        font-weight: bold;\n        font-size: 34px;\n      }\n\n      .amount-box span {\n        font-size: 18px;\n        font-weight: bold;\n      }\n\n      .amount-box h1 {\n        font-size: 18px;\n        font-weight: bold;\n        text-align: center;\n        line-height: 1.2em;\n        margin: 0;\n        padding: 0.5rem 0 0 0;\n      }\n\n      .btn-yes-donor {\n        font-size: 24px;\n        display: block;\n        width: 100%;\n        padding: 0.625em;\n        margin-top: 1em;\n        background-color: #6D94C9;\n        color: #fff;\n        border-radius: 5px;\n        border: 0;\n        font-weight: bold;\n        line-height: normal;\n        margin-bottom: 0.625em;\n        outline: none;\n        cursor: pointer;\n      }\n\n      .btn-yes-donor:active {\n        background-color: #344D6F;\n      }\n\n      .btn-yes-donor:disabled {\n        cursor: progress;\n        background-color: gray;\n        border: 2px solid gray;\n      }\n\n      .later {\n        color: #c23e3e;\n        text-decoration: none;\n        cursor: pointer;\n        font-size: 14px;\n      }\n    "]);return pe=function(){return e},e}function fe(){var e=ge(['\n      <button class="btn-yes-donor" @click='," ?disabled=",">\n        ","\n      </button>\n    "]);return fe=function(){return e},e}function he(){var e=ge(['<a class="later" target="_top" @click=',">No, thanks. Maybe next year.</a>"]);return he=function(){return e},e}function me(){var e=ge(["YES, I'll become a monthly donor"]);return me=function(){return e},e}function ye(){var e=ge(["Please wait&hellip;"]);return ye=function(){return e},e}function ve(){var e=ge(['<p class="error">',"</p>"]);return ve=function(){return e},e}function be(){var e=ge(['\n      <donation-modal\n        id="donation-upsell-modal"\n        data-id="upsell_modal"\n        title="Donation received"\n        headline="Thanks for donating. Would you consider becoming a monthly donor starting next month?"\n        message="Monthly support helps ensure that anyone curious enough to seek knowledge will be able to find it here. For free. Together we are building the public libraries of the future."\n        headerColor="#55A183"\n        .processingImageMode=','\n        showProcessingIndicator="true"\n        @close-button-pressed=','>\n\n        <div class="container">\n          <div class="amount-box">\n            <h1>Enter your monthly amount</h1>\n\n            ','\n\n            <span>\n              $<input type="text" id="upsell_amount" name="upsell_amount" value='," @keydown="," @input=",">\n            </span>\n\n          </div>\n\n          ",'\n\n          <slot name="actions"></slot>\n\n          ',"\n\n        </div>\n      </donation-modal>\n    "]);return be=function(){return e},e}function ge(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function _e(e,t,n,o,r,a,i){try{var s=e[a](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(o,r)}function we(e,t){return!t||"object"!==de(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ke(e){return(ke=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Se(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function Pe(e,t,n){return t&&Se(e.prototype,t),n&&Se(e,n),e}function Ce(e,t){return(Ce=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}ue.polyfill=!0,self.fetch||(self.fetch=ue,self.Headers=Q,self.Request=ae,self.Response=se);var Oe=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=we(this,ke(t).call(this))).upsellValue=5,e.errorMessage="",e.showUpsellButton=!1,e.upsellIsProcessing=!1,e.transactionData={},e.paymentService="",e.donationType="braintree",e.defaultErrorMessage="We're sorry, but we were unable to set up monthly donations. Please contact donations@archive.org for assistance.",e}var n,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ce(e,t)}(t,f["a"]),Pe(t,null,[{key:"properties",get:function(){return{donationType:{type:String},errorMessage:{type:String},paymentService:{type:String},showUpsellButton:{type:Boolean},transactionData:{type:Object},upsellIsProcessing:{type:Boolean},upsellValue:{type:Number}}}}]),Pe(t,[{key:"firstUpdated",value:function(){this.setUpsellAmount()}},{key:"setUpsellAmount",value:function(){var e=Donations.getDonationAmount(),t=5;e>25&&e<=100?t=10:e>100&&(t=25),this.upsellValue=t}},{key:"doUpsell",value:(n=regeneratorRuntime.mark(function e(){var t,n,o,r,a,i,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.upsellIsProcessing=!0,this.errorMessage="",t=this.postData,n=t.amount,parseInt(n,10)>0){e.next=9;break}return this.errorMessage="Amount must be at least $1.",this.upsellIsProcessing=!1,e.abrupt("return");case 9:if(!(this.upsellValue>9999)){e.next=13;break}return this.errorMessage="To make a donation of $10,000 or more, please contact our philanthropy department at donations@archive.org",this.upsellIsProcessing=!1,e.abrupt("return");case 13:return o="".concat(Donations.baseURL,"/services/braintree-charge.php"),r=Object.keys(t).map(function(e){return"".concat(encodeURIComponent(e),"=").concat(encodeURIComponent(t[e]))}).join("&"),e.next=17,ue(o,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},body:r});case 17:return a=e.sent,e.next=20,a.json();case 20:if(!((i=e.sent).error||i.type&&"error"===i.type)){e.next=25;break}return this.errorMessage=this.defaultErrorMessage,this.upsellIsProcessing=!1,e.abrupt("return");case 25:(s=$("#stripeComplete")).find("[name=email]").val(t.email),s.find("[name=first_name]").val(t.firstName),s.find("[name=last_name]").val(t.lastName),s.find("[name=amount]").val(Donations.getDonationAmount()),s.find('[name="charge-id"]').val(this.transactionData.transaction_id),s.find('[name="donation-type"]').val("upsell"),s.find('[name="upsell-amount"]').val(t.amount),s.find('[name="upsell-charge-id"]').val(i.result.subscription.id),s.find("[name=service]").val(this.paymentService),s.submit();case 36:case"end":return e.stop()}},e,this)}),o=function(){var e=this,t=arguments;return new Promise(function(o,r){var a=n.apply(e,t);function i(e){_e(a,o,r,i,s,"next",e)}function s(e){_e(a,o,r,i,s,"throw",e)}i(void 0)})},function(){return o.apply(this,arguments)})},{key:"render",value:function(){return Object(f.c)(be(),S.complete,this.closeButonPressed,this.errorMessage?Object(f.c)(ve(),this.errorMessage):"",this.upsellValue,t.validateInput,this.changeUpsellAmount,this.showUpsellButton?this.upsellButtonTemplate:"",this.shouldShowNoThanksButton?this.noThanksButtonTemplate:"")}},{key:"changeUpsellAmount",value:function(e){var n=e.target.value;this.upsellValue=t.getSanitizedUpsellAmount(n)}},{key:"upsellButtonClicked",value:function(){this.emitUpsellButtonClickedEvent(),this.upsellIsProcessing=!this.upsellIsProcessing,this.doUpsell()}},{key:"emitUpsellButtonClickedEvent",value:function(){var e=new Event("upsell-button-clicked");this.dispatchEvent(e)}},{key:"closeButonPressed",value:function(){var e=new Event("close-button-pressed");this.dispatchEvent(e)}},{key:"noThanksButtonPressed",value:function(){var e=new Event("no-thanks-button-pressed");this.dispatchEvent(e)}},{key:"postData",get:function(){var e=this.transactionData,t=e.customer,n=e.billing;return{email:t.email,firstName:t.firstName,lastName:t.lastName,streetAddress:n.streetAddress,extendedAddress:n.extendedAddress||"",locality:n.locality,region:n.region,postalCode:n.postalCode,bt_country:n.countryCodeAlpha2,amount:this.upsellValue,customer_id:e.customer_id,payment_method_nonce:e.paymentMethodNonce,"donation-type":this.donationType,type:"monthly",up_sell:"true",csrf_token:Donations.csrf_token}}},{key:"upsellButtonMessage",get:function(){return this.upsellIsProcessing?Object(f.c)(ye()):Object(f.c)(me())}},{key:"noThanksButtonTemplate",get:function(){return Object(f.c)(he(),this.noThanksButtonPressed)}},{key:"upsellButtonTemplate",get:function(){return Object(f.c)(fe(),this.upsellButtonClicked,this.upsellIsProcessing,this.upsellButtonMessage)}},{key:"shouldShowNoThanksButton",get:function(){return!this.upsellIsProcessing}}],[{key:"validateInput",value:function(e){"Backspace"!==e.key&&(t.sanitizeUpsellAmount(e.key)||e.preventDefault())}},{key:"sanitizeUpsellAmount",value:function(e){return/[0-9.,]/.test(e)}},{key:"getSanitizedUpsellAmount",value:function(e){return e.replace(/[,.](\d)$/,":$10").replace(/[,.](\d)(\d)$/,":$1$2").replace(/[$£€¥,.]/g,"").replace(/:/,".")}},{key:"styles",get:function(){return Object(f.b)(pe())}}]),t}();function Ee(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}customElements.define("upsell-modal",Oe);var je=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.selector=t,this.authorization=Object(q.a)("[property=braintree_token]").attr("content")}var t,n,o;return t=e,o=[{key:"renderProcessingModal",value:function(){e.removeProcessingModal();var t="donation-processing-modal";e.modalSetup(),Object(q.a)(document.body).append('\n      <donation-modal\n        id="'.concat(t,'"\n        title="Processing your Donation"\n        headerColor="#497fbf"\n        processingImageMode="').concat(S.processing,'"\n        showProcessingIndicator="true">\n\n      </donation-modal>\n    ')),document.querySelector("#".concat(t)).addEventListener("close-button-pressed",e.removeProcessingModal)}},{key:"removeProcessingModal",value:function(){var t=document.querySelector("#donation-processing-modal");t&&(t.remove(),e.modalTeardown())}},{key:"renderDonationReceivedModal",value:function(){e.removeDonationReceivedModal();var t="donation-received-modal";e.modalSetup(),Object(q.a)(document.body).append('\n      <donation-modal\n        id="'.concat(t,'"\n        title="Donation received"\n        headerColor="#55A183"\n        processingImageMode="').concat(S.complete,'"\n        showProcessingIndicator="true">\n\n      </donation-modal>\n    ')),document.querySelector("#".concat(t)).addEventListener("close-button-pressed",e.removeDonationReceivedModal)}},{key:"removeDonationReceivedModal",value:function(){var t=document.querySelector("#donation-received-modal");t&&(t.remove(),e.modalTeardown())}},{key:"renderUpsellModal",value:function(t,n,o,r){e.removeUpsellModal();e.modalSetup(),Object(q.a)(document.body).append('\n      <upsell-modal\n        id="'.concat("donation-upsell-modal",'"\n        showUpsellButton="true"\n        paymentService="').concat(t,'">\n      </upsell-modal>\n    '));var a=document.querySelector("#".concat("donation-upsell-modal"));a.transactionData=n,e.bindUpsellModalEvents(a,o,r)}},{key:"bindUpsellModalEvents",value:function(t,n,o){t.addEventListener("close-button-pressed",function(){o(),e.removeUpsellModal(),H.postMessage("open modal")}),t.addEventListener("no-thanks-button-pressed",function(){o(),e.removeUpsellModal(),H.postMessage("open modal")}),t.addEventListener("upsell-button-clicked",function(){n()})}},{key:"removeUpsellModal",value:function(){var t=document.querySelector("#donation-upsell-modal");t&&(t.remove(),e.modalTeardown())}},{key:"renderErrorModal",value:function(){e.removeErrorModal();e.modalSetup(),Object(q.a)(document.body).append('\n      <donation-modal\n        id="'.concat("donation-error-modal",'"\n        title="Processing error"\n        headline="There\'s been a problem processing your donation."\n        message="You may try again later or select a different payment method."\n        headerColor="#691916">\n\n        <a class="error-modal-faq-link"\n          title="Questions?"\n          target="_blank"\n          rel="noopener noreferrer"\n          href="https://help.archive.org/hc/en-us/articles/360037568971-Why-is-there-a-problem-processing-my-donation-">\n          Questions?\n        </a>\n      </donation-modal>\n    ')),document.querySelector("#".concat("donation-error-modal")).addEventListener("close-button-pressed",e.removeErrorModal)}},{key:"removeErrorModal",value:function(){var t=document.querySelector("#donation-error-modal");t&&(t.remove(),e.modalTeardown())}},{key:"modalSetup",value:function(){Object(q.a)(".js-ia-iframe").length||Object(q.a)(document.body).addClass("overflow-hidden"),Object(q.a)("[data-id=backdrop]").removeClass("hidden"),H.postMessage("open modal")}},{key:"modalTeardown",value:function(){Object(q.a)(document.body).removeClass("overflow-hidden"),Object(q.a)("[data-id=backdrop]").addClass("hidden"),H.postMessage("close modal")}}],(n=[{key:"createCallback",value:function(e,t){e?Object(r.a)(e):this.enablePaymentMethod(t)}},{key:"submitNonce",value:function(e){return q.a.ajax({type:"POST",url:this.endpoint,data:e})}},{key:"chargeCompleted",value:function(){var e=this.transaction,t=e.customer,n=void 0===t?{}:t,o=e["upsell-amount"],r=e["upsell-charge-id"],a={amount:Donations.getDonationAmount(),"charge-id":this.transaction_id,"donation-type":Donations.getFrequency(),first_name:n.firstName,last_name:n.lastName,email:n.email};o&&(a["upsell-amount"]=o,a["upsell-charge-id"]=r,a["donation-type"]="upsell"),Donations.setDonationCookie(45),L({action:"".concat(Donations.baseURL,"/services/donate.php?service=").concat(this.service),fields:a})}}])&&Ee(t.prototype,n),o&&Ee(t,o),e}(),xe=n(3),Ae={};try{!function(e,t){if("+"!==new e("q=%2B").get("q")||"+"!==new e({q:"+"}).get("q")||"+"!==new e([["q","+"]]).get("q")||"q=%0A"!==new e("q=\n").toString()||"q=+%26"!==new e({q:" &"}).toString()||"q=%25zx"!==new e({q:"%zx"}).toString())throw e;Ae.URLSearchParams=e}(URLSearchParams)}catch(e){!function(e,t,n){var o=e.create,r=e.defineProperty,a=/[!'\(\)~]|%20|%00/g,i=/%(?![0-9a-fA-F]{2})/g,s=/\+/g,c={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"},l={append:function(e,t){f(this._ungap,e,t)},delete:function(e){delete this._ungap[e]},get:function(e){return this.has(e)?this._ungap[e][0]:null},getAll:function(e){return this.has(e)?this._ungap[e].slice(0):[]},has:function(e){return e in this._ungap},set:function(e,n){this._ungap[e]=[t(n)]},forEach:function(e,n){var o=this;for(var r in o._ungap)o._ungap[r].forEach(a,r);function a(a){e.call(n,a,t(r),o)}},toJSON:function(){return{}},toString:function(){var e=[];for(var t in this._ungap)for(var n=m(t),o=0,r=this._ungap[t];o<r.length;o++)e.push(n+"="+m(r[o]));return e.join("&")}};for(var u in l)r(d.prototype,u,{configurable:!0,writable:!0,value:l[u]});function d(e){var t=o(null);switch(r(this,"_ungap",{value:t}),!0){case!e:break;case"string"==typeof e:"?"===e.charAt(0)&&(e=e.slice(1));for(var a=e.split("&"),i=0,s=a.length;i<s;i++){var c=(l=a[i]).indexOf("=");-1<c?f(t,h(l.slice(0,c)),h(l.slice(c+1))):l.length&&f(t,h(l),"")}break;case n(e):for(i=0,s=e.length;i<s;i++){var l;f(t,(l=e[i])[0],l[1])}break;case"forEach"in e:e.forEach(p,t);break;default:for(var u in e)f(t,u,e[u])}}function p(e,t){f(this,t,e)}function f(e,t,o){var r=n(o)?o.join(","):o;t in e?e[t].push(r):e[t]=[r]}function h(e){return decodeURIComponent(e.replace(i,"%25").replace(s," "))}function m(e){return encodeURIComponent(e).replace(a,y)}function y(e){return c[e]}Ae.URLSearchParams=d}(Object,String,Array.isArray)}!function(e){var t=!1;try{t=!!Symbol.iterator}catch(e){}function n(e,n){var o=[];return e.forEach(n,o),t?o[Symbol.iterator]():{next:function(){var e=o.shift();return{done:void 0===e,value:e}}}}"forEach"in e||(e.forEach=function(e,t){var n=this,o=Object.create(null);this.toString().replace(/=[\s\S]*?(?:&|$)/g,"=").split("=").forEach(function(r){!r.length||r in o||(o[r]=n.getAll(r)).forEach(function(o){e.call(t,o,r,n)})})}),"keys"in e||(e.keys=function(){return n(this,function(e,t){this.push(t)})}),"values"in e||(e.values=function(){return n(this,function(e,t){this.push(e)})}),"entries"in e||(e.entries=function(){return n(this,function(e,t){this.push([t,e])})}),!t||Symbol.iterator in e||(e[Symbol.iterator]=e.entries),"sort"in e||(e.sort=function(){for(var e,t,n,o=this.entries(),r=o.next(),a=r.done,i=[],s=Object.create(null);!a;)t=(n=r.value)[0],i.push(t),t in s||(s[t]=[]),s[t].push(n[1]),a=(r=o.next()).done;for(i.sort(),e=0;e<i.length;e++)this.delete(i[e]);for(e=0;e<i.length;e++)t=i[e],this.append(t,s[t].shift())}),function(t){var n=t.defineProperty,o=t.getOwnPropertyDescriptor,r=function(t){var n=t.append;t.append=e.append,URLSearchParams.call(t,t._usp.search.slice(1)),t.append=n},a=function(e,t){if(!(e instanceof t))throw new TypeError("'searchParams' accessed on an object that does not implement interface "+t.name)},i=function(i){var s,c,l=i.prototype,u=o(l,"searchParams"),d=o(l,"href"),p=o(l,"search");!u&&p&&p.set&&(c=function(t){function o(n,o){e.append.call(this,n,o),n=this.toString(),t.set.call(this._usp,n?"?"+n:"")}function r(n){e.delete.call(this,n),n=this.toString(),t.set.call(this._usp,n?"?"+n:"")}function a(n,o){e.set.call(this,n,o),n=this.toString(),t.set.call(this._usp,n?"?"+n:"")}return function(e,t){return e.append=o,e.delete=r,e.set=a,n(e,"_usp",{configurable:!0,writable:!0,value:t})}}(p),s=function(e,t){return n(e,"_searchParams",{configurable:!0,writable:!0,value:c(t,e)}),t},t.defineProperties(l,{href:{get:function(){return d.get.call(this)},set:function(e){var t=this._searchParams;d.set.call(this,e),t&&r(t)}},search:{get:function(){return p.get.call(this)},set:function(e){var t=this._searchParams;p.set.call(this,e),t&&r(t)}},searchParams:{get:function(){return a(this,i),this._searchParams||s(this,new URLSearchParams(this.search.slice(1)))},set:function(e){a(this,i),s(this,e)}}}))};try{i(HTMLAnchorElement),/^function|object$/.test("undefined"==typeof URL?"undefined":t(xe.a)(URL))&&URL.prototype&&i(URL)}catch(e){}}(Object)}(Ae.URLSearchParams.prototype);var Te=Ae.URLSearchParams;function De(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var Me="braintree-hosted-fields-focused",$e=function(e){$(e.currentTarget).closest(".field").addClass(Me)},Be=function(e){$(e.currentTarget).closest(".field").removeClass(Me)},Ne=function(e){var t=e.emittedBy,n=e.fields[t].container;$(n).removeClass("error-border no-border-bottom")},Ie=function(e){var t=e.emittedBy,n=e.fields[t],o=n.container;n.isEmpty&&$(o).addClass("error-border")},Ue=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.authorization=$("[property=braintree_token]").attr("content"),this.namespace="CreditCard",this.service="braintree",this.btHostedFieldsInstance=null,this.defaultErrorMessage="We're sorry, but we were unable to process your donation. Please contact donations@archive.org for assistance.",e.renderModal(),this.$form=$("#braintree-popup [data-id=braintree]"),this.init()}var t,n,o;return t=e,o=[{key:"renderModal",value:function(){var e=document.querySelector("#braintree-popup");e&&e.parentNode.removeChild(e);$(document.body).append(F({amount:Donations.getDonationAmount(),frequency:"monthly"===Donations.getFrequency()?"monthly":"",referrer:Donations.getReferer()})),je.modalSetup(),document.querySelector("#braintree-popup").addEventListener("close-button-pressed",function(e){e.target.visible=!1,je.modalTeardown()})}},{key:"catchTokenizeError",value:function(e){Object(r.a)("Error: CreditCard.processDonation tokenize: ".concat(e))}}],(n=[{key:"createCallback",value:function(e,t){e?Object(r.a)(e):this.renderBraintreeFields(t)}},{key:"clearHostedFields",value:function(){var e=this;if(this.btHostedFieldsInstance){var t=this.btHostedFieldsInstance.getState().fields,n=void 0===t?{}:t;Object.keys(n).forEach(function(t){e.btHostedFieldsInstance.clear(t)})}}},{key:"renderBraintreeFields",value:function(e){var t=this,n={client:e,styles:l,fields:u};braintree.hostedFields.create(n,function(n,o){n&&Object(r.a)(n),t.btHostedFieldsInstance=o,t.btHostedFieldsInstance.on("focus",Ne),t.btHostedFieldsInstance.on("blur",Ie),t.bindDOMEvents(e,o)}),document.querySelector("#braintree-popup").scrollIntoView(!0)}},{key:"processDonation",value:function(t){var n=this;$(".js-cc-donate-button").prop("disabled",!0);var o=t.data.fields,a="one-time"===Donations.getFrequency();t.preventDefault(),o.tokenize(function(t,o){if(t)return e.catchTokenizeError(t),void n.displayErrorMessage(t);n.$form.find("#bt_amount").val(Donations.getDonationAmount()),n.$form.find("#bt_nonce").val(o.nonce);var i=n.$form.serializeArray(),s=new Te(window.location.search).get("test_fraud");s&&i.push({name:"test_fraud",value:s}),n.hideError(),je.renderProcessingModal(),$("#braintree-popup")[0].visible=!1,$(document.body).removeClass("overflow-hidden");var c=$.now();$.ajax({type:"POST",url:"".concat(Donations.baseURL,"/services/braintree-charge.php"),data:i,success:function(e){var t=$.now()-c;setTimeout(function(){n.transaction=e,n.transaction_id=n.transaction.transaction_id,je.removeProcessingModal(),n.transaction.error?je.renderErrorModal():a?n.showUpsell(n.transaction):(je.renderDonationReceivedModal(),n.chargeCompleted())},t<500?t:0)},error:function(e,t){var o=$.now()-c;setTimeout(function(){Object(r.a)("Error: CreditCard.processDonation: ".concat(t)),je.removeProcessingModal(),je.renderErrorModal(),n.displayErrorMessage(t)},o<500?o:0)}})})}},{key:"showUpsell",value:function(e){var t=this;je.renderUpsellModal(this.service,e,function(){Object(r.a)("Agreed to set up monthly donations")},function(){Object(r.a)("Declined to set up monthly donations"),t.chargeCompleted(e)})}},{key:"hideError",value:function(){this.$form.find(".error").removeClass("visible")}},{key:"displayErrorMessage",value:function(e){var t,n,o=d,r=e.code,a=void 0===r?"":r,i=e.details,s=e.error,c="HOSTED_FIELDS_FIELDS_EMPTY"===a,l="HOSTED_FIELDS_FIELDS_INVALID"===a,u=!!(void 0===s?null:s),p=o[a]||this.defaultErrorMessage;if(u&&(p=this.parseBTErrorMessages(e.error.errors)),this.renderError(p),c&&this.btHostedFieldsInstance){var f=this.btHostedFieldsInstance.getState().fields;!function(e){Object.keys(e).forEach(function(t){var n=e[t].container,o="error-border ".concat("number"===t?"no-border-bottom":"");$(n).addClass(o)})}(void 0===f?{}:f)}l&&(n=(t=i).invalidFields,t.invalidFieldKeys.forEach(function(e){var t=n[e];$(t).addClass("error-border")})),$(".js-cc-donate-button").removeProp("disabled")}},{key:"parseBTErrorMessages",value:function(e){var t=e.reduce(function(e,t){var n=e?"".concat(e,"<br />"):"";return"".concat(n).concat(t.message)},"");return e.length||(t=this.defaultErrorMessage),t}},{key:"renderError",value:function(e){this.$form.find(".error").text(e).addClass("visible")}},{key:"chargeCompleted",value:function(){var e=this.transaction.customer;Donations.setDonationCookie(45),L({action:"".concat(Donations.baseURL,"/services/donate.php?service=braintree"),fields:{amount:Donations.getDonationAmount(),"charge-id":this.transaction_id,"donation-type":Donations.getFrequency(),first_name:e.firstName,last_name:e.lastName,email:e.email}})}},{key:"bindDOMEvents",value:function(e,t){this.$form.on("submit.".concat(this.namespace),{client:e,fields:t},this.processDonation.bind(this)),this.$form.on("focus.".concat(this.namespace),"input",$e),this.$form.on("blur.".concat(this.namespace),"input",Be)}},{key:"init",value:function(){var e=this.authorization,t="braintree_".concat($.now());this.$form.attr("id",t),braintree.client.create({authorization:e},this.createCallback.bind(this))}}])&&De(t.prototype,n),o&&De(t,o),e}();function Re(e){return(Re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Fe(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function Le(e,t){return!t||"object"!==Re(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function qe(e){return(qe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ze(e,t){return(ze=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ve=function(e){function t(e){var n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=Le(this,qe(t).call(this,e))).endpoint="".concat(Donations.baseURL,"/services/paypal-charge.php"),n.service="paypal",n.isUpSell=o.isUpSell,n.frequency=o.frequency,n.flowType=o.flowType,n.transaction_id=o.transaction_id,n.defaultErrorMessage="We're sorry, but we were unable to process your donation. Please contact donations@archive.org for assistance.",braintree.client.create({authorization:n.authorization},function(e,t){e?Object(r.a)(e):braintree.dataCollector.create({client:t,paypal:!0},function(e,o){e?Object(r.a)(e):(n.deviceData=o.deviceData,n.enablePaymentMethod(t))})}),n}var n,o,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ze(e,t)}(t,je),n=t,a=[{key:"renderUpsellModal",value:function(e,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:$.noop,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:$.noop;je.removeUpsellModal();var a="donation-upsell-modal";je.modalSetup(),$(document.body).append('\n      <upsell-modal\n        id="'.concat(a,'"\n        paymentService="').concat(e,'">\n        <div slot="actions" class="actions">\n          <p>Click the PayPal button to donate monthly</p>\n          <div id="paypal-upsell"></div>\n        </div>\n      </upsell-modal>\n    '));var i=document.querySelector("#".concat(a));i.transactionData=n,i.donationType="paypal",i.updateComplete.then(function(){return t.renderPayPalUpsellButton(n)}),je.bindUpsellModalEvents(i,o,r)}},{key:"renderPayPalUpsellButton",value:function(e){new t("#paypal-upsell",{flowType:"vault",isUpSell:!0,frequency:"monthly",transaction_id:e.transaction_id})}}],(o=[{key:"submitPayment",value:function(e){var t=this,n=e.details.shippingAddress,o="one-time"===this.getFrequency(),a={nonce:e.nonce,type:this.getFrequency(),amount:this.getDonationAmount(),referrer:Donations.getReferer(),payerId:e.details.payerId,email:e.details.email,firstName:e.details.firstName,lastName:e.details.lastName,streetAddress:n.line1,extendedAddress:n.line2,locality:n.city,region:n.state,postalCode:n.postalCode,countryCodeAlpha2:n.countryCode,deviceData:this.deviceData};this.isUpSell&&(a.up_sell=!0,a.paypal_checkout_id=this.transaction_id);var i=this.submitNonce(a);je.removeUpsellModal(),i.done(function(e){t.transaction=JSON.parse(e),t.transaction.error?t.displayErrorMessage(t.transaction):(t.isUpSell?(t.transaction["upsell-charge-id"]=t.transaction.transaction_id,t.transaction["upsell-amount"]=a.amount):t.transaction_id=t.transaction.transaction_id,je.removeProcessingModal(),o?t.showUpsell(t.transaction):(je.renderDonationReceivedModal(),t.chargeCompleted()))}).fail(function(e,t){Object(r.a)("Error: PayPal.submitNonce: ".concat(t)),je.removeProcessingModal(),je.renderErrorModal()}),je.renderProcessingModal()}},{key:"showUpsell",value:function(e){var n=this;t.renderUpsellModal(this.service,e,function(){Object(r.a)("Agreed to set up monthly donations")},function(){Object(r.a)("Declined to set up monthly donations"),n.chargeCompleted()})}},{key:"displayErrorMessage",value:function(e){e.code;var t=e.message||this.defaultErrorMessage;$(document.body).append('\n      <donation-modal\n        id="'.concat("paypal-error",'"\n        title="Processing error"\n        headline="There\'s been a problem processing your donation."\n        message="').concat(t,'"\n        headerColor="#691916">\n      </donation-modal>\n    ')),$("#".concat("paypal-error")).on("close-button-pressed",function(e){e.target.remove()})}},{key:"getFlowType",value:function(){return this.flowType?this.flowType:"monthly"===this.getFrequency()?"vault":"checkout"}},{key:"getFrequency",value:function(){return this.frequency||Donations.getFrequency()}},{key:"getDonationAmount",value:function(){var e=$("upsell-modal")[0];return e?e.upsellValue:Donations.getDonationAmount()}},{key:"getPaymentOptions",value:function(){var e=this.getFlowType(),t=this.getDonationAmount(),n={flow:e,enableShippingAddress:!0};return"checkout"===e?Object.assign(n,{amount:t,currency:"USD"}):Object.assign(n,{billingAgreementDescription:"Subscribe to donate $".concat(t," monthly")}),n}},{key:"enablePaymentMethod",value:function(e){var t=this;$(".payment-options .paypal").show(),braintree.paypalCheckout.create({client:e},function(e,n){e?Object(r.a)(e):(t.instance=n,paypal.Button.render({env:Donations.getEnvironment(),style:{color:"blue",label:"paypal",size:"medium",tagline:!1},payment:function(){var e=Donations.getDonationContext().replace(/^(\w)/,function(e,t){return t.toUpperCase()}),o="Banner"===e?Donations.getDonationPlatform():"",a="one-time"===Donations.getFrequency()?"OneTime":"Monthly";try{archive_analytics.send_event("Donate".concat(e).concat(o),"PmtPaypal".concat(a),window.location.pathname,{service:"ao_no_sampling"})}catch(e){Object(r.a)("archive_analytics not available on window object")}return H.postMessage("open modal"),n.createPayment(t.getPaymentOptions())},onAuthorize:function(e,o){return H.postMessage("close modal"),n.tokenizePayment(e,function(e,n){e?Object(r.a)(e):(t.submitPayment(n),Object(r.a)(n))})},onCancel:function(e){H.postMessage("close modal"),Object(r.a)("PayPal payment cancelled",JSON.stringify(e,0,2))},onError:function(e){H.postMessage("close modal"),Object(r.a)("PayPal error: ".concat(e))}},t.selector).then(function(){Object(r.a)("PayPal button set up")}))})}}])&&Fe(n.prototype,o),a&&Fe(n,a),t}();function He(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var Ge=function(){function e(){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!e.checkBrowserSupport())return Object(r.a)("Using a browser without Apple Pay support. Skipping initialization");this.$el=$(".apple-pay-button");var t=$("[property=braintree_token]").attr("content");this.authorization=t,braintree.client.create({authorization:t},this.createCallback.bind(this))}var t,n,o;return t=e,o=[{key:"checkBrowserSupport",value:function(){return!1}}],(n=[{key:"createCallback",value:function(e,t){if(e)return Object(r.a)(e);this.renderApplePayButton(t)}},{key:"renderApplePayButton",value:function(e){var t=this;braintree.applePay.create({client:e},function(e,n){if(e)return Object(r.a)("Error creating applePayInstance: ".concat(e));ApplePaySession.canMakePaymentsWithActiveCard(n.merchantIdentifier).then(function(e){e&&(Object(r.a)("Apple Pay button set up"),t.bindApplePayButton())}).catch(function(e){Object(r.a)(e)})})}},{key:"bindApplePayButton",value:function(){this.$el.on("click.applePay",function(){Object(r.a)("Initialized ApplePay")})}}])&&He(t.prototype,n),o&&He(t,o),e}();function We(e){return(We="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Je(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function Ke(e){return(Ke=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ye(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ze(e,t){return(Ze=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Qe=function(e){function t(e){var n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=function(e,t){return!t||"object"!==We(t)&&"function"!=typeof t?Ye(e):t}(this,Ke(t).call(this,e))).selector=e,n.endpoint="".concat(Donations.baseURL,"/services/venmo-charge.php"),n.service="venmo";var o=$("[property=braintree_token]").attr("content");return n.authorization=o,braintree.client.create({authorization:o,allowNewBrowserTab:!1},n.createCallback.bind(Ye(n))),n}var n,o,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ze(e,t)}(t,je),n=t,a=[{key:"chargeCompleted",value:function(e){Donations.setDonationCookie(45),L({action:"".concat(Donations.baseURL,"/services/donate.php?service=venmo"),fields:{amount:Donations.getDonationAmount(),"charge-id":e,"donation-type":Donations.getFrequency()}})}},{key:"getVenmoID",value:function(){return $("meta[property=venmo_id]").attr("content")}}],(o=[{key:"submitPayment",value:function(e,t){var n=this,o=e.details.shippingAddress,a=void 0===o?{}:o,i="one-time"===Donations.getFrequency(),s={nonce:e.nonce,type:Donations.getFrequency(),amount:Donations.getDonationAmount(),referrer:Donations.getReferer(),payerId:e.details.payerId,email:e.details.email,firstName:e.details.firstName,lastName:e.details.lastName,streetAddress:a.line1,extendedAddress:a.line2,locality:a.city,region:a.state,postalCode:a.postalCode,deviceData:t};this.submitNonce(s).done(function(e){n.transaction=JSON.parse(e),n.transaction_id=n.transaction.transaction_id,i?n.showUpsell(n.transaction):(je.renderDonationReceivedModal(),n.chargeCompleted())}).fail(function(e,t){Object(r.a)("Error: Venmo.submitNonce: ".concat(t)),je.renderError(t)}).always(function(){je.removeProcessingModal()}),je.renderProcessingModal()}},{key:"showUpsell",value:function(e){var t=this;je.renderUpsellModal(this.service,e,function(){Object(r.a)("Agreed to set up monthly donations")},function(){Object(r.a)("Declined to set up monthly donations"),t.chargeCompleted(e)})}},{key:"enablePaymentMethod",value:function(e){var n=this;braintree.venmo.create({client:e,profileId:t.getVenmoID()},function(t,o){t?Object(r.a)(t):(n.client=e,n.instance=o,o.isBrowserSupported()?/CriOS/.test(navigator.userAgent)||/Firefox/.test(navigator.userAgent)||/FxiOS/.test(navigator.userAgent)||$(".payment-options .venmo").show():Object(r.a)("Venmo not supported in this browser"))})}},{key:"handleClick",value:function(){var e=this,t=!!Donations.getDonationAmount(),n=$(this.selector);if(!t)return!1;n.attr("disabled",!0),braintree.dataCollector.create({client:this.client,paypal:!0},function(t,o){e.instance.tokenize(function(t,a){n.removeAttr("disabled"),e.submitPayment(a,o.deviceData),Object(r.a)(a)})})}}])&&Je(n.prototype,o),a&&Je(n,a),t}(),Xe={selector:"#payment-trigger",apple_pay:function(){Object(r.a)("not implemented")},google_pay:function(){Donations.google_pay.handleClick()},venmo:function(){Donations.venmo.handleClick()},paypal:function(){},credit_card:function(){new Ue},verifyFieldsComplete:function(){var e=Donations.getDonationAmount(),t=Donations.getFrequency();return!!e&&!!t},initPaymentType:function(e){this.paymentType=e,this.verifyFieldsComplete()&&this[e]&&this[e]()},choosePaymentType:function(e){e.preventDefault();var t=$("[name=payment_method]").filter(":checked").val();Xe.initPaymentType(t)}},et=Xe,tt=function(e){return{charge_token:e.id,email:e.email,isbn:Object(o.a)().isbn,context:Object(o.a)().context,type:$('input[name="type"]:checked').val(),financial_type:"Book Sponsorship",amount:Donations.getDonationAmount(1),source:Donations.enhancedDonationSource($("#stripeOneTime").attr("data-source")),csrf_token:Donations.csrf_token,address_city:e.card.address_city,address_state:e.card.address_state,address_zip:e.card.address_zip,address_country:e.card.address_country,sponsor_msg:$("#sponsorshipMessage").val(),join_waitlist:$('[name="waitlist"]').is(":checked"),sponsor_publicly:$('[name="public"]').is(":checked")}};function nt(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var ot=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"initCommentForm",value:function(){document.getElementById("post-donation-survey")&&c.init()}},{key:"loadBraintreeScript",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:$.noop,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};a("https://js.braintreegateway.com/web/".concat("3.50.1","/js/").concat(e,".js"),t,n)}},{key:"loadBraintreeBase",value:function(t){e.loadBraintreeScript("client.min",function(){e.loadBraintreeScript("hosted-fields.min",t)})}},{key:"enableJS",value:function(){$(document.body).removeClass("nojs")}},{key:"prepopulateDonationHandler",value:function(t){var n=Object(o.a)(),r=n.amt,a=n.contrib_type,i=n.d;Object.keys(n).length&&(r&&e.prepopulateAmount(r),a&&e.prepopulateFrequency(a),t&&i&&t(30))}},{key:"prepopulateAmount",value:function(e){$("#amount_".concat(parseInt(e,10)||5)).attr("checked","checked").length||($("#custamt").prop("checked",!0),$("#amount_custom").val(parseInt(e,10))),$("#paypal-button").removeClass("disabled")}},{key:"prepopulateFrequency",value:function(e){$("#".concat("once"!==e?"type_subscription":"type_oneoff")).attr("checked","checked")}},{key:"setPaypalHandlerSupport",value:function(){var e={"one-time":2,monthly:5};$("[name=type], [name=amount]").on("change",function(){var t=e[$("[name=type]:checked").val()],n=$("[name=amount]:checked").val();$("#a".concat(t)).val(n)})}},{key:"setBaseURL",value:function(){e.baseURL=$("#stripeOneTime").attr("data-base-url")||""}},{key:"setCSRFToken",value:function(){e.csrf_token=$('meta[property="csrf-token"]').attr("content")}},{key:"getEnvironment",value:function(){return $("meta[property=environment]").attr("content")}},{key:"getReferer",value:function(){return e.enhancedDonationSource($(".js-donation-refs").first().attr("data-source"))}},{key:"renderModalBackdrop",value:function(){$(document.body).append('<div data-id="backdrop" class="backdrop hidden"></div>')}},{key:"init",value:function(){!function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200;"undefined"==typeof jQuery&&setTimeout(function(){e(t,n)},n),t()}(function(){e.hidePayPalButton(),e.enableJS(),e.setCSRFToken(),e.prepopulateDonationHandler(e.setDonationCookie),e.setPaypalHandlerSupport(),e.setBaseURL(),e.handlePayPalButtonVisibility(),e.renderModalBackdrop();var t=Object(o.a)()||{};t.type&&"sponsorship"===t.type?e.configureStripe($("#stripe_public_key").val()):e.loadBraintreeBase(function(){$("[data-id=startDonation]").removeClass("hidden"),e.initPayPal(),e.bindEvents()})})}},{key:"getDonationAmount",value:function(){var t=e.minimumAmount();if($("#custamt").is(":checked"))return e.getSanitizedCustomAmount();var n,o,r=$("input[name=amount]:checked").val();return null!==(o=(n=/^\$?\s*(\d+\.?\d*)\s*$/).exec(r))&&(o.index===n.lastIndex&&(n.lastIndex+=1),parseFloat(o[1])>=t)?parseFloat(o[1]):null}},{key:"setupUpSellPopUp",value:function(e,t){var n=t;n<=10?n=5:n>10&&n<=25?n=10:n>25&&n<=100?n=25:n>100&&(n=50),$("#customer_id").val(e),$("#upsell_amount").val(n)}},{key:"getFrequency",value:function(){return $("[name=type]:checked").val()}},{key:"isFrequencyOptionSelected",value:function(){return $("[name=type]:checked").length>0}},{key:"isSubscriptionSelected",value:function(){return $("#type_subscription").is(":checked")}},{key:"minimumAmount",value:function(){return this.isSubscriptionSelected()?1:5}},{key:"maximumAmount",value:function(){return 9999}},{key:"showMinimumDonationAlert",value:function(){alert("To help prevent fraud, this page can only accept donations between $5 and $9,999.\n\nTo make a donation of $10,000 or more, please contact our philanthropy department at donations@archive.org")}},{key:"getDonationContext",value:function(){return/donatePage/.test($(document.body).attr("class"))?"page":"banner"}},{key:"getDonationPlatform",value:function(){var e=$(".js-donation-refs");return 0===e.count?"IA":e.first().attr("data-platform")||"IA"}},{key:"upSellYesEvent",value:function(){var t=$("#customer_id").val(),n=e.getDonationAmount(),o=e.csrf_token;if(t&&n&&!(n<1)){var r=$("#up_sell_yes").prop("disabled",!0),a={up_sell:"true",customer_id:t,amount:n,csrf_token:o,currency:"usd"};$.ajax({url:"".concat(e.baseURL,"/services/stripe-charge.php"),type:"post",data:a,success:function(e){var t=$.parseJSON(e);if(t.status){var o=t.data||{charge_id:"unknown"},a=$("#stripeComplete");a.find('input[name="donation-type"]').val("upsell"),a.find('input[name="upsell-amount"]').val(n),a.find('input[name="upsell-charge-id"]').val(o.charge_id),a.submit()}else alert("We apologize but something went wrong.  Will you please try again?"),r.removeAttr("disabled")},error:e.stripeChargeError})}}},{key:"stripeChargeError",value:function(){AJS.modal_add("#stripe-charge-error",{title:"Processing Error",body:"<p>We're sorry, but we've encountered an error in processing your\n              donation. You may try again or\n                <a href=\"mailto:donations@archive.org?subject=[Donation Error]Unable to Donate via Stripe\">contact us</a>\n              for assistance.</p>"}).modal("show"),e.closeUpSellModal(!0)}},{key:"closeUpSellModal",value:function(e){$("#upsell-popup").add("#upsell-popup + .modal-backdrop").removeClass("in").delay(150).hide(),e||$("#stripeComplete").submit()}},{key:"setDonationCookie",value:function(e){var t=parseInt(e,10);if(t){H.postMessage("set cookie",t);var n={path:"/",expires:t,domain:".archive.org"};"undefined"!=typeof Cookies&&(Cookies.set("donation","x",n),Cookies.set("donation","x",$.extend(n,{domain:".openlibrary.org"})))}}},{key:"enhancedDonationSource",value:function(e){var t=e;if(t)return e.match(/ctx=page/)?e.match(/;ref=/)||(t+=";ref=".concat(encodeURIComponent(document.referrer))):e.match(/;url=/)||(t+=";url=".concat(encodeURIComponent(location.href))),t}},{key:"sendStripeToken",value:function(t,n){var o=$(".upsell-popup"),a=o.find("#up_sell_yes, .later").hide(),i=o.find("#pending");$.ajax({url:"".concat(e.baseURL,"/services/stripe-charge.php"),type:"post",data:n,success:function(o){var s=$.parseJSON(o),c=t.email,l=n.amount,u=n.type,d=s.status,p=s.data,f=p.charge_id,h=p.customer_id;if(Object(r.a)(s),d)if(void 0!==f&&void 0!==h){var m=$("#stripeComplete");m.find('input[name="email"]').val(c),m.find('input[name="amount"]').val(l),m.find('input[name="charge-id"]').val(f),m.find('input[name="donation-type"]').val(u),e.setDonationCookie(45),"one-time"===u?(e.setupUpSellPopUp(h,l),a.show(),i.hide()):m.submit()}else e.stripeChargeError();else e.stripeChargeError()},error:e.stripeChargeError}),"one-time"===n.type&&e.showUpsellPopup()}},{key:"showUpsellPopup",value:function(){var e=$(".upsell-popup"),t=e.next(".modal-backdrop");e.add(t).removeClass("in").show().addClass("in")}},{key:"collectStripeData",value:function(t){return"sponsorship"===Object(o.a)().type?tt(t):{charge_token:t.id,email:t.email,type:$('input[name="type"]:checked').val(),amount:e.getDonationAmount(1),source:e.enhancedDonationSource($("#stripeOneTime").attr("data-source")),csrf_token:e.csrf_token,address_city:t.card.address_city,address_state:t.card.address_state,address_zip:t.card.address_zip,address_country:t.card.address_country}}},{key:"configureStripe",value:function(t){var n=StripeCheckout.configure({key:t,image:"".concat(e.baseURL,"/images/logo_arches.png"),token:function(t){Object(r.a)(t);var n=e.collectStripeData(t);Object(r.a)(n),e.sendStripeToken(t,n)}});e.bindStripeClickEvents(n)}},{key:"bindStripeClickEvents",value:function(t){var n=function(n){var o=e.getDonationAmount(1);if(o){var r=100*o;"undefined"!=typeof archive_analytics&&archive_analytics.send_event("DonatePage","CreditCard".concat(n.data.frequency.replace(/\s/g,"")),window.location.pathname,{service:"ao_no_sampling"}),t.open({image:"".concat(e.baseURL,"/images/logo_arches.png"),name:"Internet Archive",description:"".concat(n.data.frequency," Donation"),amount:r,panelLabel:"Donate {{amount}} ".concat(n.data.frequency),billingAddress:!0}),n.preventDefault()}};$("#stripeMonthly").on("click",{frequency:"Monthly"},n),$("#stripeOneTime").on("click",{frequency:"One Time"},n),$(window).on("popstate",function(){return t.close()})}},{key:"setupStripeHandler",value:function(){"undefined"!=typeof StripeCheckout?e.configureStripe($("#stripe_public_key").val()):a("https://checkout.stripe.com/checkout.js",function(){e.configureStripe($("#stripe_public_key").val())})}},{key:"hidePayPalButton",value:function(){$("#paypal-button").addClass("hidden")}},{key:"showPayPalButton",value:function(){$("#paypal-button").removeClass("hidden")}},{key:"clearCustomAmount",value:function(){"amount_custom"!==this.id&&$("#".concat("amount_custom")).val("")}},{key:"inputMaskOnCustomAmount",value:function(e){var t=e.which||e.keyCode;return t>=48&&t<=57}},{key:"handlePayPalButtonVisibility",value:function(){e.shouldShowPayPalButton()?e.showPayPalButton():e.hidePayPalButton()}},{key:"handleCustomAmountFocus",value:function(){$("#custamt").prop("checked",!0),$("#amount_custom").is(":focus")||$("#amount_custom").focus()}},{key:"handleDonationTypeChange",value:function(){e.toggleSelectFrequencyError(!1),$("#custamt").prop("checked")&&e.validateCustomAmount()}},{key:"handleDonationAmountButtonChange",value:function(){e.clearCustomAmount(),e.toggleLowDonationError(!1),e.toggleHighDonationError(!1)}},{key:"amountIsValid",value:function(){var t=$("input[type=radio][name=amount]:checked").length>0,n=$("#custamt").is(":checked");if(t&&!n)return!0;var o=this.minimumAmount(),r=e.getSanitizedCustomAmount(),a=parseFloat(r),i=r.length>0&&!isNaN(a)&&(a>=o&&a<1e4);return i}},{key:"shouldShowPayPalButton",value:function(){return!!this.isFrequencyOptionSelected()&&(!!this.amountIsValid()&&(!($("input[type=radio][name=payment_method]").length>0)||"paypal"===$("[name=payment_method]:checked").val()))}},{key:"initPayPal",value:function(){a("https://www.paypalobjects.com/api/checkout.js",function(){e.loadBraintreeScript("paypal-checkout.min",function(){e.loadBraintreeScript("data-collector.min",function(){e.paypal=new Ve("#paypal-button")})})},{"data-version-4":"1","log-level":"warn"})}},{key:"initVenmo",value:function(){e.loadBraintreeScript("venmo.min",function(){e.loadBraintreeScript("data-collector.min",function(){e.venmo=new Qe("#venmo-button")})})}},{key:"initCreditCard",value:function(t){t.preventDefault(),e.validatePaymentSettings(function(){if(new Ue,"banner"===e.getDonationContext()){var t=e.getDonationPlatform(),n="one-time"===e.getFrequency()?"OneTime":"Monthly";try{archive_analytics.send_event("DonateBanner".concat(t),"PmtCreditCard".concat(n),window.location.pathname,{service:"ao_no_sampling"})}catch(e){Object(r.a)("archive_analytics not available on window object")}}})}},{key:"initApplePay",value:function(){e.loadBraintreeScript("apple-pay.min",function(){e.apple_pay=new Ge})}},{key:"initGooglePay",value:function(){a("https://pay.google.com/gp/p/js/pay.js",function(){e.loadBraintreeScript("google-payment.min",function(){e.google_pay=new GooglePay("#google-pay-button")})})}},{key:"initBannerPaymentMethods",value:function(){$("#google_pay-button").on("click",function(){e.validatePaymentSettings(function(){et.google_pay()})}),$("#venmo-button").on("click",function(){e.validatePaymentSettings(function(){et.venmo()})})}},{key:"toggleLowDonationError",value:function(t){$("[data-id=highDonationError]").addClass("hidden"),$("[data-id=lowDonationError]").toggleClass("hidden",!t),$("[data-id=minAmount]").text(e.minimumAmount())}},{key:"toggleSelectFrequencyError",value:function(e){$("[data-id=selectFrequencyError]").toggleClass("hidden",!e)}},{key:"toggleHighDonationError",value:function(e){$("[data-id=lowDonationError]").addClass("hidden"),$("[data-id=highDonationError]").toggleClass("hidden",!e)}},{key:"sanitizeCustomInput",value:function(e){if("ArrowLeft"!==e.code&&"ArrowRight"!==e.code&&"ArrowUp"!==e.code&&"ArrowDown"!==e.code&&"Delete"!==e.code&&"Backspace"!==e.code){var t=String.fromCharCode(e.which);return/[0-9.,]/.test(t)}}},{key:"getSanitizedCustomAmount",value:function(){return $("#amount_custom").val().replace(/[,.](\d)$/,":$10").replace(/[,.](\d)(\d)$/,":$1$2").replace(/[$£€¥,.]/g,"").replace(/:/,".")}},{key:"validateCustomAmount",value:function(){var t=e.getSanitizedCustomAmount(),n=e.minimumAmount();e.toggleLowDonationError(!1),null===t||isNaN(t)||t<=0||t<n?e.toggleLowDonationError(!0):t>e.maximumAmount()&&e.toggleHighDonationError(!0)}},{key:"bindEvents",value:function(){$("#braintreeOneTime").on("click",e.initCreditCard),$(".donate-form-section input[type=radio][name=type]").on("click",e.handlePayPalButtonVisibility).on("change",e.handleDonationTypeChange),$(".donate-form-section input[type=radio][name=amount]").on("click",e.handleDonationAmountButtonChange).on("click",e.handlePayPalButtonVisibility),$("#amount_custom").on("keypress",e.sanitizeCustomInput).on("input change",e.validateCustomAmount).on("input",e.handlePayPalButtonVisibility).on("focus",e.handleCustomAmountFocus).on("focus",e.handlePayPalButtonVisibility),$(".custom-amount-wrapper").on("click",e.handleCustomAmountFocus),$(".payment-options input").on("change",e.handlePayPalButtonVisibility),$(".payment-method-alert-handler").on("click",function(){e.showMinimumDonationAlert()}),$("[data-id=startDonation]").on("click",e.startDonationButtonClicked),$("#donate_later").on("click",function(){return H.openReminderForm()}),$("#close_donate_dropdown").on("click",function(){return H.closeReminderForm()}),$(".js-payment-options").on("click",function(){var e=$(".js-donate-dropdown");e.hasClass("is-open")&&e.removeClass("is-open")}),$("#donate_close_desktop").on("click",function(){return H.postMessage("hide banner",3)})}},{key:"validatePaymentSettings",value:function(t){e.isFrequencyOptionSelected()?e.amountIsValid()?void 0!==t&&t():e.showMinimumDonationAlert():e.toggleSelectFrequencyError(!0)}},{key:"startDonationButtonClicked",value:function(t){e.validatePaymentSettings(function(){try{archive_analytics.send_event("DonatePage","PmtDonateButton",window.location.pathname,{service:"ao_no_sampling"})}catch(e){Object(r.a)("archive_analytics not available on window object")}et.choosePaymentType(t)})}}],(n=null)&&nt(t.prototype,n),i&&nt(t,i),e}();function rt(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}ot.RemindForm=s,window&&window.AJS&&(window.AJS.setDonateBannerSuppressionCookie=ot.setDonationCookie),window.Donations=ot,$(function(){$(".donate-form-section").length>0&&(window.Donations.init(),window.Donations.initBannerPaymentMethods()),window.Donations.initCommentForm()});var at=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,o;return t=e,o=[{key:"addevent",value:function(e,t,n){e&&(e.attachEvent?e.attachEvent("on".concat(t),n):e.addEventListener(t,n))}},{key:"uncheckOnOwnAmount",value:function(){e.addevent(document.getElementById("other_amt"),"click",function(){document.getElementById("custamt").checked=!0})}},{key:"addCloseSupport",value:function(){var t=function(){H.postMessage("hide banner",3),document.getElementById("donate_banner").style.display="none",ot.setDonationCookie(3)};e.addevent(document.getElementById("donate_close_desktop"),"click",t),e.addevent(document.getElementById("donate_close_mobile"),"click",t)}},{key:"handlePaypalSubmission",value:function(){e.addevent(document.getElementById("paypal-one-time"),"submit",function(t){e.populatePaypalTransactionFields(2,"paypal-one-time")||(t.stopPropagation(),t.preventDefault())}),e.addevent(document.getElementById("paypal-monthly"),"submit",function(t){e.populatePaypalTransactionFields(5,"paypal-monthly")||(t.stopPropagation(),t.preventDefault())})}},{key:"donateLoaderJS",value:function(){ot.enableJS(),e.uncheckOnOwnAmount(),ot.setupStripeHandler(),ot.setBaseURL(),e.addCloseSupport(),new ot.RemindForm($("#donate_reminder_form"),$("#donate_later"),ot.setDonationCookie)}},{key:"populatePaypalTransactionFields",value:function(e,t){if(!1===ot.getDonationAmount(e))return!1;var n=document.querySelector("#".concat(t," input[name=custom]"));return n&&(n.value=ot.enhancedDonationSource(n.value)),!0}}],(n=null)&&rt(t.prototype,n),o&&rt(t,o),e}();$(at.donateLoaderJS)}});
//# sourceMappingURL=donation-banner.min.js.map